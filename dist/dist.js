/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(function webpackUniversalModuleDefinition(root, factory) {
	if(typeof exports === 'object' && typeof module === 'object')
		module.exports = factory();
	else if(typeof define === 'function' && define.amd)
		define("ComponentRelay", [], factory);
	else if(typeof exports === 'object')
		exports["ComponentRelay"] = factory();
	else
		root["ComponentRelay"] = factory();
})(self, function() {
return /******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./lib/componentRelay.ts":
/*!*******************************!*\
  !*** ./lib/componentRelay.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ ComponentRelay)\n/* harmony export */ });\n/* harmony import */ var _snjsTypes__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./snjsTypes */ \"./lib/snjsTypes.ts\");\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./utils */ \"./lib/utils.ts\");\n/* harmony import */ var _logger__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./logger */ \"./lib/logger.ts\");\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n\n\n\nconst DEFAULT_COALLESED_SAVING_DELAY = 250;\nvar MessagePayloadApi;\n\n(function (MessagePayloadApi) {\n  MessagePayloadApi[\"Component\"] = \"component\";\n})(MessagePayloadApi || (MessagePayloadApi = {}));\n\nvar KeyboardModifier;\n\n(function (KeyboardModifier) {\n  KeyboardModifier[\"Shift\"] = \"Shift\";\n  KeyboardModifier[\"Ctrl\"] = \"Control\";\n  KeyboardModifier[\"Meta\"] = \"Meta\";\n})(KeyboardModifier || (KeyboardModifier = {}));\n\nclass ComponentRelay {\n  constructor(params) {\n    _defineProperty(this, \"contentWindow\", void 0);\n\n    _defineProperty(this, \"initialPermissions\", void 0);\n\n    _defineProperty(this, \"onReadyCallback\", void 0);\n\n    _defineProperty(this, \"component\", {\n      activeThemes: [],\n      acceptsThemes: true\n    });\n\n    _defineProperty(this, \"sentMessages\", []);\n\n    _defineProperty(this, \"messageQueue\", []);\n\n    _defineProperty(this, \"lastStreamedItem\", void 0);\n\n    _defineProperty(this, \"pendingSaveItems\", void 0);\n\n    _defineProperty(this, \"pendingSaveTimeout\", void 0);\n\n    _defineProperty(this, \"pendingSaveParams\", void 0);\n\n    _defineProperty(this, \"coallesedSaving\", true);\n\n    _defineProperty(this, \"coallesedSavingDelay\", DEFAULT_COALLESED_SAVING_DELAY);\n\n    _defineProperty(this, \"messageHandler\", void 0);\n\n    _defineProperty(this, \"keyDownEventListener\", void 0);\n\n    _defineProperty(this, \"keyUpEventListener\", void 0);\n\n    _defineProperty(this, \"clickEventListener\", void 0);\n\n    _defineProperty(this, \"onThemesChangeCallback\", void 0);\n\n    _defineProperty(this, \"concernTimeouts\", []);\n\n    if (!params || !params.targetWindow) {\n      throw new Error('contentWindow must be a valid Window object.');\n    }\n\n    this.contentWindow = params.targetWindow;\n    this.processParameters(params);\n    this.registerMessageHandler();\n    this.registerKeyboardEventListeners();\n    this.registerMouseEventListeners();\n  }\n\n  processParameters(params) {\n    var _options$debug;\n\n    const {\n      initialPermissions,\n      options,\n      onReady,\n      onThemesChange\n    } = params;\n\n    if (initialPermissions && initialPermissions.length > 0) {\n      this.initialPermissions = initialPermissions;\n    }\n\n    if ((0,_utils__WEBPACK_IMPORTED_MODULE_1__.isNotUndefinedOrNull)(options === null || options === void 0 ? void 0 : options.coallesedSaving)) {\n      this.coallesedSaving = options.coallesedSaving;\n    }\n\n    if ((0,_utils__WEBPACK_IMPORTED_MODULE_1__.isNotUndefinedOrNull)(options === null || options === void 0 ? void 0 : options.coallesedSavingDelay)) {\n      this.coallesedSavingDelay = options.coallesedSavingDelay;\n    }\n\n    if ((0,_utils__WEBPACK_IMPORTED_MODULE_1__.isNotUndefinedOrNull)(options === null || options === void 0 ? void 0 : options.acceptsThemes)) {\n      var _options$acceptsTheme;\n\n      this.component.acceptsThemes = (_options$acceptsTheme = options === null || options === void 0 ? void 0 : options.acceptsThemes) !== null && _options$acceptsTheme !== void 0 ? _options$acceptsTheme : true;\n    }\n\n    if ((0,_utils__WEBPACK_IMPORTED_MODULE_1__.isNotUndefinedOrNull)(onReady)) {\n      this.onReadyCallback = onReady;\n    }\n\n    if ((0,_utils__WEBPACK_IMPORTED_MODULE_1__.isNotUndefinedOrNull)(onThemesChange)) {\n      this.onThemesChangeCallback = onThemesChange;\n    }\n\n    _logger__WEBPACK_IMPORTED_MODULE_2__.default.enabled = (_options$debug = options === null || options === void 0 ? void 0 : options.debug) !== null && _options$debug !== void 0 ? _options$debug : false;\n  }\n\n  deinit() {\n    this.onReadyCallback = undefined;\n    this.component = {\n      acceptsThemes: true,\n      activeThemes: []\n    };\n    this.messageQueue = [];\n    this.sentMessages = [];\n    this.lastStreamedItem = undefined;\n    this.pendingSaveItems = undefined;\n    this.pendingSaveTimeout = undefined;\n    this.pendingSaveParams = undefined;\n\n    if (this.messageHandler) {\n      this.contentWindow.document.removeEventListener('message', this.messageHandler);\n      this.contentWindow.removeEventListener('message', this.messageHandler);\n    }\n\n    if (this.keyDownEventListener) {\n      this.contentWindow.removeEventListener('keydown', this.keyDownEventListener);\n    }\n\n    if (this.keyUpEventListener) {\n      this.contentWindow.removeEventListener('keyup', this.keyUpEventListener);\n    }\n\n    if (this.clickEventListener) {\n      this.contentWindow.removeEventListener('click', this.clickEventListener);\n    }\n  }\n\n  registerMessageHandler() {\n    this.messageHandler = event => {\n      _logger__WEBPACK_IMPORTED_MODULE_2__.default.info('Components API Message received:', event.data);\n      /**\n       * We don't have access to window.parent.origin due to cross-domain restrictions.\n       * Check referrer if available, otherwise defer to checking for first-run value.\n       * Craft URL objects so that example.com === example.com/\n       */\n\n      if (document.referrer) {\n        const referrer = new URL(document.referrer).origin;\n        const eventOrigin = new URL(event.origin).origin;\n\n        if (referrer !== eventOrigin) {\n          return;\n        }\n      } // Mobile environment sends data as JSON string.\n\n\n      const {\n        data\n      } = event;\n      const parsedData = (0,_utils__WEBPACK_IMPORTED_MODULE_1__.isValidJsonString)(data) ? JSON.parse(data) : data;\n\n      if (!parsedData) {\n        _logger__WEBPACK_IMPORTED_MODULE_2__.default.error('Invalid data received. Skipping...');\n        return;\n      }\n      /**\n       * The Component Registered message will be the most reliable one, so we won't change it after any subsequent events,\n       * in case you receive an event from another window.\n       */\n\n\n      if (typeof this.component.origin === 'undefined' && parsedData.action === _snjsTypes__WEBPACK_IMPORTED_MODULE_0__.ComponentAction.ComponentRegistered) {\n        this.component.origin = event.origin;\n      } else if (event.origin !== this.component.origin) {\n        // If event origin doesn't match first-run value, return.\n        return;\n      }\n\n      this.handleMessage(parsedData);\n    };\n    /**\n     * Mobile (React Native) uses `document`, web/desktop uses `window`.addEventListener\n     * for postMessage API to work properly.\n     * Update May 2019:\n     * As part of transitioning React Native webview into the community package,\n     * we'll now only need to use window.addEventListener.\n     * However, we want to maintain backward compatibility for Mobile < v3.0.5, so we'll keep document.addEventListener\n     * Also, even with the new version of react-native-webview, Android may still require document.addEventListener (while iOS still only requires window.addEventListener)\n     * https://github.com/react-native-community/react-native-webview/issues/323#issuecomment-467767933\n     */\n\n\n    this.contentWindow.document.addEventListener('message', this.messageHandler, false);\n    this.contentWindow.addEventListener('message', this.messageHandler, false);\n    _logger__WEBPACK_IMPORTED_MODULE_2__.default.info('Waiting for messages...');\n  }\n\n  registerKeyboardEventListeners() {\n    this.keyDownEventListener = event => {\n      _logger__WEBPACK_IMPORTED_MODULE_2__.default.info(\"A key has been pressed: \".concat(event.key));\n\n      if (event.ctrlKey) {\n        this.keyDownEvent(KeyboardModifier.Ctrl);\n      } else if (event.shiftKey) {\n        this.keyDownEvent(KeyboardModifier.Shift);\n      } else if (event.metaKey || event.key === 'Meta') {\n        this.keyDownEvent(KeyboardModifier.Meta);\n      }\n    };\n\n    this.keyUpEventListener = event => {\n      _logger__WEBPACK_IMPORTED_MODULE_2__.default.info(\"A key has been released: \".concat(event.key));\n      /**\n       * Checking using event.key instead of the corresponding boolean properties.\n       */\n\n      if (event.key === 'Control') {\n        this.keyUpEvent(KeyboardModifier.Ctrl);\n      } else if (event.key === 'Shift') {\n        this.keyUpEvent(KeyboardModifier.Shift);\n      } else if (event.key === 'Meta') {\n        this.keyUpEvent(KeyboardModifier.Meta);\n      }\n    };\n\n    this.contentWindow.addEventListener('keydown', this.keyDownEventListener, false);\n    this.contentWindow.addEventListener('keyup', this.keyUpEventListener, false);\n  }\n\n  registerMouseEventListeners() {\n    this.clickEventListener = _event => {\n      _logger__WEBPACK_IMPORTED_MODULE_2__.default.info('A click has been performed.');\n      this.mouseClickEvent();\n    };\n\n    this.contentWindow.addEventListener('click', this.clickEventListener, false);\n  }\n\n  handleMessage(payload) {\n    switch (payload.action) {\n      case _snjsTypes__WEBPACK_IMPORTED_MODULE_0__.ComponentAction.ComponentRegistered:\n        this.component.sessionKey = payload.sessionKey;\n\n        if (payload.componentData) {\n          this.component.data = payload.componentData;\n        }\n\n        this.onReady(payload.data);\n        _logger__WEBPACK_IMPORTED_MODULE_2__.default.info('Component successfully registered with payload:', payload);\n        break;\n\n      case _snjsTypes__WEBPACK_IMPORTED_MODULE_0__.ComponentAction.ActivateThemes:\n        this.activateThemes(payload.data.themes);\n        break;\n\n      default:\n        {\n          var _this$sentMessages, _originalMessage$call;\n\n          if (!payload.original) {\n            return;\n          } // Get the callback from queue.\n\n\n          const originalMessage = (_this$sentMessages = this.sentMessages) === null || _this$sentMessages === void 0 ? void 0 : _this$sentMessages.filter(message => {\n            var _payload$original;\n\n            return message.messageId === ((_payload$original = payload.original) === null || _payload$original === void 0 ? void 0 : _payload$original.messageId);\n          })[0];\n\n          if (!originalMessage) {\n            // Connection must have been reset. We should alert the user unless it's a reply,\n            // in which case we may have been deallocated and reinitialized and lost the\n            // original message\n            const extensionName = this.contentWindow.document.title;\n            const alertMessage = (\"The extension '\".concat(extensionName, \"' is attempting to communicate with Standard Notes, \") + 'but an error is preventing it from doing so. Please restart this extension and try again.').replace('  ', ' ');\n            _logger__WEBPACK_IMPORTED_MODULE_2__.default.info(alertMessage);\n            return;\n          }\n\n          originalMessage === null || originalMessage === void 0 ? void 0 : (_originalMessage$call = originalMessage.callback) === null || _originalMessage$call === void 0 ? void 0 : _originalMessage$call.call(originalMessage, payload.data);\n          break;\n        }\n    }\n  }\n\n  onReady(data) {\n    this.component.environment = data.environment;\n    this.component.platform = data.platform;\n    this.component.uuid = data.uuid;\n\n    if (this.initialPermissions && this.initialPermissions.length > 0) {\n      this.requestPermissions(this.initialPermissions);\n    }\n\n    for (const message of this.messageQueue) {\n      this.postMessage(message.action, message.data, message.callback);\n    }\n\n    this.messageQueue = [];\n    _logger__WEBPACK_IMPORTED_MODULE_2__.default.info('Data passed to onReady:', data);\n    this.activateThemes(data.activeThemeUrls || []); // After activateThemes is done, we want to send a message with the ThemesActivated action.\n\n    this.postMessage(_snjsTypes__WEBPACK_IMPORTED_MODULE_0__.ComponentAction.ThemesActivated, {});\n\n    if (this.onReadyCallback) {\n      this.onReadyCallback();\n    }\n  }\n  /**\n   * Gets the component UUID.\n   */\n\n\n  getSelfComponentUUID() {\n    return this.component.uuid;\n  }\n  /**\n   * Checks if the component is running in a Desktop application.\n   */\n\n\n  isRunningInDesktopApplication() {\n    return this.component.environment === (0,_utils__WEBPACK_IMPORTED_MODULE_1__.environmentToString)(_snjsTypes__WEBPACK_IMPORTED_MODULE_0__.Environment.Desktop);\n  }\n  /**\n   * Checks if the component is running in a Mobile application.\n   */\n\n\n  isRunningInMobileApplication() {\n    return this.component.environment === (0,_utils__WEBPACK_IMPORTED_MODULE_1__.environmentToString)(_snjsTypes__WEBPACK_IMPORTED_MODULE_0__.Environment.Mobile);\n  }\n  /**\n   * Gets the component's data value for the specified key.\n   * @param key The key for the data object.\n   * @returns `undefined` if the value for the key does not exist. Returns the stored value otherwise.\n   */\n\n\n  getComponentDataValueForKey(key) {\n    if (!this.component.data) {\n      return;\n    }\n\n    return this.component.data[key];\n  }\n  /**\n   * Sets the component's data value for the specified key.\n   * @param key The key for the data object.\n   * @param value The value to store under the specified key.\n   */\n\n\n  setComponentDataValueForKey(key, value) {\n    if (!this.component.data) {\n      throw new Error('The component has not been initialized.');\n    }\n\n    if (!key || key && key.length === 0) {\n      throw new Error('The key for the data value should be a valid string.');\n    }\n\n    this.component.data = _objectSpread(_objectSpread({}, this.component.data), {}, {\n      [key]: value\n    });\n    this.postMessage(_snjsTypes__WEBPACK_IMPORTED_MODULE_0__.ComponentAction.SetComponentData, {\n      componentData: this.component.data\n    });\n  }\n  /**\n   * Clears the component's data object.\n   */\n\n\n  clearComponentData() {\n    this.component.data = {};\n    this.postMessage(_snjsTypes__WEBPACK_IMPORTED_MODULE_0__.ComponentAction.SetComponentData, {\n      componentData: this.component.data\n    });\n  }\n\n  postMessage(action, data, callback) {\n    /**\n     * If the sessionKey is not set, we push the message to queue\n     * that will be processed later on.\n     */\n    if (!this.component.sessionKey) {\n      this.messageQueue.push({\n        action,\n        data,\n        api: MessagePayloadApi.Component,\n        callback: callback\n      });\n      return;\n    }\n\n    const message = {\n      action,\n      data,\n      messageId: this.generateUUID(),\n      sessionKey: this.component.sessionKey,\n      api: MessagePayloadApi.Component\n    };\n    const sentMessage = JSON.parse(JSON.stringify(message));\n    sentMessage.callback = callback;\n    this.sentMessages.push(sentMessage);\n    let postMessagePayload; // Mobile (React Native) requires a string for the postMessage API.\n\n    if (this.isRunningInMobileApplication()) {\n      postMessagePayload = JSON.stringify(message);\n    } else {\n      postMessagePayload = message;\n    }\n\n    _logger__WEBPACK_IMPORTED_MODULE_2__.default.info('Posting message:', postMessagePayload);\n    this.contentWindow.parent.postMessage(postMessagePayload, this.component.origin);\n  }\n\n  requestPermissions(permissions, callback) {\n    this.postMessage(_snjsTypes__WEBPACK_IMPORTED_MODULE_0__.ComponentAction.RequestPermissions, {\n      permissions\n    }, () => {\n      callback && callback();\n    });\n  }\n\n  activateThemes() {\n    let incomingUrls = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n\n    if (!this.component.acceptsThemes) {\n      return;\n    }\n\n    _logger__WEBPACK_IMPORTED_MODULE_2__.default.info('Incoming themes:', incomingUrls);\n    const {\n      activeThemes\n    } = this.component;\n\n    if (activeThemes && activeThemes.sort().toString() == incomingUrls.sort().toString()) {\n      // Incoming theme URLs are same as active, do nothing.\n      return;\n    }\n\n    let themesToActivate = incomingUrls;\n    const themesToDeactivate = [];\n\n    for (const activeUrl of activeThemes) {\n      if (!incomingUrls.includes(activeUrl)) {\n        // Active not present in incoming, deactivate it.\n        themesToDeactivate.push(activeUrl);\n      } else {\n        // Already present in active themes, remove it from themesToActivate.\n        themesToActivate = themesToActivate.filter(candidate => {\n          return candidate !== activeUrl;\n        });\n      }\n    }\n\n    _logger__WEBPACK_IMPORTED_MODULE_2__.default.info('Deactivating themes:', themesToDeactivate);\n    _logger__WEBPACK_IMPORTED_MODULE_2__.default.info('Activating themes:', themesToActivate);\n\n    for (const themeUrl of themesToDeactivate) {\n      this.deactivateTheme(themeUrl);\n    }\n\n    this.component.activeThemes = incomingUrls;\n\n    for (const themeUrl of themesToActivate) {\n      if (!themeUrl) {\n        continue;\n      }\n\n      const link = this.contentWindow.document.createElement('link');\n      link.id = btoa(themeUrl);\n      link.href = themeUrl;\n      link.type = 'text/css';\n      link.rel = 'stylesheet';\n      link.media = 'screen,print';\n      link.className = 'custom-theme';\n      this.contentWindow.document.getElementsByTagName('head')[0].appendChild(link);\n    }\n\n    this.onThemesChangeCallback && this.onThemesChangeCallback();\n  }\n\n  themeElementForUrl(themeUrl) {\n    const elements = Array.from(this.contentWindow.document.getElementsByClassName('custom-theme')).slice();\n    return elements.find(element => {\n      // We used to search here by `href`, but on desktop, with local file:// urls, that didn't work for some reason.\n      return element.id == btoa(themeUrl);\n    });\n  }\n\n  deactivateTheme(themeUrl) {\n    const element = this.themeElementForUrl(themeUrl);\n\n    if (element && element.parentNode) {\n      element.setAttribute('disabled', 'true');\n      element.parentNode.removeChild(element);\n    }\n  }\n\n  generateUUID() {\n    return (0,_utils__WEBPACK_IMPORTED_MODULE_1__.generateUuid)();\n  }\n  /**\n   * Gets the current platform where the component is running.\n   */\n\n\n  get platform() {\n    return this.component.platform;\n  }\n  /**\n   * Gets the current environment where the component is running.\n   */\n\n\n  get environment() {\n    return this.component.environment;\n  }\n  /**\n   * Streams a collection of Items, filtered by content type.\n   * New items are passed to the callback as they come.\n   * @param contentTypes A collection of Content Types.\n   * @param callback A callback to process the streamed items.\n   */\n\n\n  streamItems(contentTypes, callback) {\n    this.postMessage(_snjsTypes__WEBPACK_IMPORTED_MODULE_0__.ComponentAction.StreamItems, {\n      content_types: contentTypes\n    }, data => {\n      callback(data.items);\n    });\n  }\n  /**\n   * Streams the current Item in context.\n   * @param callback A callback to process the streamed item.\n   */\n\n\n  streamContextItem(callback) {\n    this.postMessage(_snjsTypes__WEBPACK_IMPORTED_MODULE_0__.ComponentAction.StreamContextItem, {}, data => {\n      const {\n        item\n      } = data;\n      /**\n       * If this is a new context item than the context item the component was currently entertaining,\n       * we want to immediately commit any pending saves, because if you send the new context item to the\n       * component before it has commited its presave, it will end up first replacing the UI with new context item,\n       * and when the debouncer executes to read the component UI, it will be reading the new UI for the previous item.\n       */\n\n      const isNewItem = !this.lastStreamedItem || this.lastStreamedItem.uuid !== item.uuid;\n\n      if (isNewItem && this.pendingSaveTimeout) {\n        clearTimeout(this.pendingSaveTimeout);\n        this.performSavingOfItems(this.pendingSaveParams);\n        this.pendingSaveTimeout = undefined;\n        this.pendingSaveParams = undefined;\n      }\n\n      this.lastStreamedItem = item;\n      callback(this.lastStreamedItem);\n    });\n  }\n  /**\n   * Selects a `Tag` item.\n   * @param item The Item (`Tag` or `SmartTag`) to select.\n   */\n\n\n  selectItem(item) {\n    this.postMessage(_snjsTypes__WEBPACK_IMPORTED_MODULE_0__.ComponentAction.SelectItem, {\n      item: this.jsonObjectForItem(item)\n    });\n  }\n  /**\n   * Clears current selected `Tag` (if any).\n   */\n\n\n  clearSelection() {\n    this.postMessage(_snjsTypes__WEBPACK_IMPORTED_MODULE_0__.ComponentAction.ClearSelection, {\n      content_type: _snjsTypes__WEBPACK_IMPORTED_MODULE_0__.ContentType.Tag\n    });\n  }\n  /**\n   * Creates and stores an Item in the item store.\n   * @param item The Item's payload content.\n   * @param callback The callback to process the created Item.\n   */\n\n\n  createItem(item, callback) {\n    this.postMessage(_snjsTypes__WEBPACK_IMPORTED_MODULE_0__.ComponentAction.CreateItem, {\n      item: this.jsonObjectForItem(item)\n    }, data => {\n      let {\n        item\n      } = data;\n      /**\n       * A previous version of the SN app had an issue where the item in the reply to ComponentActions.CreateItems\n       * would be nested inside \"items\" and not \"item\". So handle both cases here.\n       */\n\n      if (!item && data.items && data.items.length > 0) {\n        item = data.items[0];\n      }\n\n      this.associateItem(item);\n      callback && callback(item);\n    });\n  }\n  /**\n   * Creates and stores a collection of Items in the item store.\n   * @param items The Item(s) payload collection.\n   * @param callback The callback to process the created Item(s).\n   */\n\n\n  createItems(items, callback) {\n    const mapped = items.map(item => this.jsonObjectForItem(item));\n    this.postMessage(_snjsTypes__WEBPACK_IMPORTED_MODULE_0__.ComponentAction.CreateItems, {\n      items: mapped\n    }, data => {\n      callback && callback(data.items);\n    });\n  }\n  /**\n   * Associates a `Tag` with the current Note.\n   * @param item The `Tag` item to associate.\n   */\n\n\n  associateItem(item) {\n    this.postMessage(_snjsTypes__WEBPACK_IMPORTED_MODULE_0__.ComponentAction.AssociateItem, {\n      item: this.jsonObjectForItem(item)\n    });\n  }\n  /**\n   * Deassociates a `Tag` with the current Note.\n   * @param item The `Tag` item to deassociate.\n   */\n\n\n  deassociateItem(item) {\n    this.postMessage(_snjsTypes__WEBPACK_IMPORTED_MODULE_0__.ComponentAction.DeassociateItem, {\n      item: this.jsonObjectForItem(item)\n    });\n  }\n  /**\n   * Deletes an Item from the item store.\n   * @param item The Item to delete.\n   * @param callback The callback with the result of the operation.\n   */\n\n\n  deleteItem(item, callback) {\n    this.deleteItems([item], callback);\n  }\n  /**\n   * Deletes a collection of Items from the item store.\n   * @param items The Item(s) to delete.\n   * @param callback The callback with the result of the operation.\n   */\n\n\n  deleteItems(items, callback) {\n    const params = {\n      items: items.map(item => {\n        return this.jsonObjectForItem(item);\n      })\n    };\n    this.postMessage(_snjsTypes__WEBPACK_IMPORTED_MODULE_0__.ComponentAction.DeleteItems, params, data => {\n      callback && callback(data);\n    });\n  }\n  /**\n   * Performs a custom action to the component manager.\n   * @param action\n   * @param data\n   * @param callback The callback with the result of the operation.\n   */\n\n\n  sendCustomEvent(action, data, callback) {\n    this.postMessage(action, data, data => {\n      callback && callback(data);\n    });\n  }\n  /**\n   * Saves an existing Item in the item store.\n   * @param item An existing Item to be saved.\n   * @param callback\n   * @param skipDebouncer\n   */\n\n\n  saveItem(item, callback) {\n    let skipDebouncer = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    this.saveItems([item], callback, skipDebouncer);\n  }\n  /**\n   * Runs a callback before saving an Item.\n   * @param item An existing Item to be saved.\n   * @param presave Allows clients to perform any actions last second before the save actually occurs (like setting previews).\n   * Saves debounce by default, so if a client needs to compute a property on an item before saving, it's best to\n   * hook into the debounce cycle so that clients don't have to implement their own debouncing.\n   * @param callback\n   */\n\n\n  saveItemWithPresave(item, presave, callback) {\n    this.saveItemsWithPresave([item], presave, callback);\n  }\n  /**\n   * Runs a callback before saving a collection of Items.\n   * @param items A collection of existing Items to be saved.\n   * @param presave Allows clients to perform any actions last second before the save actually occurs (like setting previews).\n   * Saves debounce by default, so if a client needs to compute a property on an item before saving, it's best to\n   * hook into the debounce cycle so that clients don't have to implement their own debouncing.\n   * @param callback\n   */\n\n\n  saveItemsWithPresave(items, presave, callback) {\n    this.saveItems(items, callback, false, presave);\n  }\n\n  performSavingOfItems(_ref) {\n    let {\n      items,\n      presave,\n      callback\n    } = _ref;\n    const ConcernIntervalMS = 5000;\n    const concernTimeout = setTimeout(() => {\n      this.concernTimeouts.forEach(timeout => clearTimeout(timeout));\n      alert('This editor is unable to communicate with Standard Notes. ' + 'Your changes may not be saved. Please backup your changes, then restart the ' + 'application and try again.');\n    }, ConcernIntervalMS);\n    this.concernTimeouts.push(concernTimeout);\n    /**\n     * Presave block allows client to gain the benefit of performing something in the debounce cycle.\n     */\n\n    presave && presave();\n    const mappedItems = [];\n\n    for (const item of items) {\n      mappedItems.push(this.jsonObjectForItem(item));\n    }\n\n    const wrappedCallback = () => {\n      this.concernTimeouts.forEach(timeout => clearTimeout(timeout));\n      callback === null || callback === void 0 ? void 0 : callback();\n    };\n\n    this.postMessage(_snjsTypes__WEBPACK_IMPORTED_MODULE_0__.ComponentAction.SaveItems, {\n      items: mappedItems\n    }, wrappedCallback);\n  }\n  /**\n   * Saves a collection of existing Items.\n   * @param items The items to be saved.\n   * @param callback\n   * @param skipDebouncer Allows saves to go through right away rather than waiting for timeout.\n   * This should be used when saving items via other means besides keystrokes.\n   * @param presave\n   */\n\n\n  saveItems(items, callback) {\n    let skipDebouncer = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    let presave = arguments.length > 3 ? arguments[3] : undefined;\n\n    /**\n     * We need to make sure that when we clear a pending save timeout,\n     * we carry over those pending items into the new save.\n     */\n    if (!this.pendingSaveItems) {\n      this.pendingSaveItems = [];\n    }\n\n    if (this.coallesedSaving && !skipDebouncer) {\n      if (this.pendingSaveTimeout) {\n        clearTimeout(this.pendingSaveTimeout);\n      }\n\n      const incomingIds = items.map(item => item.uuid);\n      /**\n       * Replace any existing save items with incoming values.\n       * Only keep items here who are not in incomingIds.\n       */\n\n      const preexistingItems = this.pendingSaveItems.filter(item => {\n        return !incomingIds.includes(item.uuid);\n      }); // Add new items, now that we've made sure it's cleared of incoming items.\n\n      this.pendingSaveItems = preexistingItems.concat(items); // We'll potentially need to commit early if stream-context-item message comes in.\n\n      this.pendingSaveParams = {\n        items: this.pendingSaveItems,\n        presave,\n        callback\n      };\n      this.pendingSaveTimeout = setTimeout(() => {\n        this.performSavingOfItems(this.pendingSaveParams);\n        this.pendingSaveItems = [];\n        this.pendingSaveTimeout = undefined;\n        this.pendingSaveParams = null;\n      }, this.coallesedSavingDelay);\n    } else {\n      this.performSavingOfItems({\n        items,\n        presave,\n        callback\n      });\n    }\n  }\n  /**\n   * Sets a new container size for the current component.\n   * @param width The new width.\n   * @param height The new height.\n   */\n\n\n  setSize(width, height) {\n    this.postMessage(_snjsTypes__WEBPACK_IMPORTED_MODULE_0__.ComponentAction.SetSize, {\n      type: 'container',\n      width,\n      height\n    });\n  }\n  /**\n   * Sends the KeyDown keyboard event to the Standard Notes parent application.\n   * @param keyboardModifier The keyboard modifier that was pressed.\n   */\n\n\n  keyDownEvent(keyboardModifier) {\n    this.postMessage(_snjsTypes__WEBPACK_IMPORTED_MODULE_0__.ComponentAction.KeyDown, {\n      keyboardModifier\n    });\n  }\n  /**\n   * Sends the KeyUp keyboard event to the Standard Notes parent application.\n   * @param keyboardModifier The keyboard modifier that was released.\n   */\n\n\n  keyUpEvent(keyboardModifier) {\n    this.postMessage(_snjsTypes__WEBPACK_IMPORTED_MODULE_0__.ComponentAction.KeyUp, {\n      keyboardModifier\n    });\n  }\n  /**\n   * Sends the Click mouse event to the Standard Notes parent application.\n   */\n\n\n  mouseClickEvent() {\n    this.postMessage(_snjsTypes__WEBPACK_IMPORTED_MODULE_0__.ComponentAction.Click, {});\n  }\n\n  jsonObjectForItem(item) {\n    const copy = Object.assign({}, item);\n    copy.children = null;\n    copy.parent = null;\n    return copy;\n  }\n  /**\n   * Gets the Item's appData value for the specified key.\n   * Uses the default domain (org.standardnotes.sn).\n   * This function is used with Items returned from streamContextItem() and streamItems()\n   * @param item The Item to get the appData value from.\n   * @param key The key to get the value from.\n   */\n\n\n  getItemAppDataValue(item, key) {\n    var _item$content, _item$content$appData;\n\n    const defaultDomain = 'org.standardnotes.sn';\n    return item === null || item === void 0 ? void 0 : (_item$content = item.content) === null || _item$content === void 0 ? void 0 : (_item$content$appData = _item$content.appData) === null || _item$content$appData === void 0 ? void 0 : _item$content$appData[defaultDomain][key];\n  }\n\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9saWIvY29tcG9uZW50UmVsYXkudHMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9Db21wb25lbnRSZWxheS8uL2xpYi9jb21wb25lbnRSZWxheS50cz81NGI0Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIEFwcERhdGFGaWVsZCxcbiAgQ29tcG9uZW50QWN0aW9uLFxuICBDb250ZW50VHlwZSxcbiAgRW52aXJvbm1lbnQsXG59IGZyb20gJy4vc25qc1R5cGVzJ1xuaW1wb3J0IHR5cGUge1xuICBDb21wb25lbnRQZXJtaXNzaW9uLFxuICBJdGVtTWVzc2FnZVBheWxvYWQsXG4gIE1lc3NhZ2VEYXRhLFxuICBTTkl0ZW0sXG4gIFV1aWRTdHJpbmcsXG59IGZyb20gJ0BzdGFuZGFyZG5vdGVzL3NuanMnXG5pbXBvcnQge1xuICBlbnZpcm9ubWVudFRvU3RyaW5nLFxuICBnZW5lcmF0ZVV1aWQsXG4gIGlzVmFsaWRKc29uU3RyaW5nLFxuICBpc05vdFVuZGVmaW5lZE9yTnVsbCxcbn0gZnJvbSAnLi91dGlscydcbmltcG9ydCBMb2dnZXIgZnJvbSAnLi9sb2dnZXInXG5cbmNvbnN0IERFRkFVTFRfQ09BTExFU0VEX1NBVklOR19ERUxBWSA9IDI1MFxuXG5lbnVtIE1lc3NhZ2VQYXlsb2FkQXBpIHtcbiAgQ29tcG9uZW50ID0gJ2NvbXBvbmVudCcsXG59XG5cbnR5cGUgQ29tcG9uZW50ID0ge1xuICB1dWlkPzogc3RyaW5nXG4gIG9yaWdpbj86IHN0cmluZ1xuICBkYXRhPzogQ29tcG9uZW50RGF0YVxuICBzZXNzaW9uS2V5Pzogc3RyaW5nXG4gIGVudmlyb25tZW50Pzogc3RyaW5nXG4gIHBsYXRmb3JtPzogc3RyaW5nXG4gIGlzTW9iaWxlPzogYm9vbGVhblxuICBhY2NlcHRzVGhlbWVzOiBib29sZWFuXG4gIGFjdGl2ZVRoZW1lczogc3RyaW5nW11cbn1cblxudHlwZSBDb21wb25lbnREYXRhID0ge1xuICBba2V5OiBzdHJpbmddOiBhbnlcbn1cblxudHlwZSBNZXNzYWdlUGF5bG9hZCA9IHtcbiAgYWN0aW9uOiBDb21wb25lbnRBY3Rpb25cbiAgZGF0YTogTWVzc2FnZURhdGFcbiAgY29tcG9uZW50RGF0YT86IENvbXBvbmVudERhdGFcbiAgbWVzc2FnZUlkPzogVXVpZFN0cmluZ1xuICBzZXNzaW9uS2V5PzogVXVpZFN0cmluZ1xuICBhcGk6IE1lc3NhZ2VQYXlsb2FkQXBpXG4gIG9yaWdpbmFsPzogTWVzc2FnZVBheWxvYWRcbiAgY2FsbGJhY2s/OiAoLi4ucGFyYW1zOiBhbnkpID0+IHZvaWRcbn1cblxudHlwZSBDb21wb25lbnRSZWxheU9wdGlvbnMgPSB7XG4gIGNvYWxsZXNlZFNhdmluZz86IGJvb2xlYW5cbiAgY29hbGxlc2VkU2F2aW5nRGVsYXk/OiBudW1iZXJcbiAgLyoqXG4gICAqIE91dHB1dHMgZGVidWdnaW5nIGluZm9ybWF0aW9uIHRvIGNvbnNvbGUuXG4gICAqL1xuICBkZWJ1Zz86IGJvb2xlYW5cbiAgLyoqXG4gICAqIEluZGljYXRlcyB3aGV0aGVyIG9yIG5vdCB0aGUgY29tcG9uZW50IGFjY2VwdHMgdGhlbWVzLlxuICAgKi9cbiAgYWNjZXB0c1RoZW1lcz86IGJvb2xlYW5cbn1cblxudHlwZSBDb21wb25lbnRSZWxheVBhcmFtcyA9IHtcbiAgLyoqXG4gICAqIFJlcHJlc2VudHMgdGhlIHdpbmRvdyBvYmplY3QgdGhhdCB0aGUgY29tcG9uZW50IGlzIHJ1bm5pbmcgaW4uXG4gICAqL1xuICB0YXJnZXRXaW5kb3c6IFdpbmRvd1xuICAvKipcbiAgICogQSBjb2xsZWN0aW9uIG9mIHBlcm1pc3Npb25zIHRoYXQgdGhlIGNvbXBvbmVudCBjYW4gcmVxdWVzdFxuICAgKiBhY2Nlc3Mgb25jZSBpdCdzIHJlYWR5LlxuICAgKi9cbiAgaW5pdGlhbFBlcm1pc3Npb25zPzogQ29tcG9uZW50UGVybWlzc2lvbltdXG4gIC8qKlxuICAgKiBUaGUgb3B0aW9ucyB0byBpbml0aWFsaXplXG4gICAqL1xuICBvcHRpb25zPzogQ29tcG9uZW50UmVsYXlPcHRpb25zXG4gIC8qKlxuICAgKiBBIGNhbGxiYWNrIHRoYXQgaXMgZXhlY3V0ZWQgYWZ0ZXIgdGhlIGNvbXBvbmVudCBoYXMgYmVlbiByZWdpc3RlcmVkLlxuICAgKi9cbiAgb25SZWFkeT86ICgpID0+IHZvaWRcbiAgLyoqXG4gICAqIEEgY2FsbGJhY2sgdGhhdCBpcyBleGVjdXRlZCBhZnRlciB0aGVtZXMgaGF2ZSBiZWVuIGNoYW5nZWQuXG4gICAqL1xuICBvblRoZW1lc0NoYW5nZT86ICgpID0+IHZvaWRcbn1cblxudHlwZSBJdGVtUGF5bG9hZCA9IHtcbiAgY29udGVudF90eXBlPzogQ29udGVudFR5cGVcbiAgY29udGVudD86IGFueVxuICBba2V5OiBzdHJpbmddOiBhbnlcbn1cblxuZW51bSBLZXlib2FyZE1vZGlmaWVyIHtcbiAgU2hpZnQgPSAnU2hpZnQnLFxuICBDdHJsID0gJ0NvbnRyb2wnLFxuICBNZXRhID0gJ01ldGEnLFxufVxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDb21wb25lbnRSZWxheSB7XG4gIHByaXZhdGUgY29udGVudFdpbmRvdzogV2luZG93XG4gIHByaXZhdGUgaW5pdGlhbFBlcm1pc3Npb25zPzogQ29tcG9uZW50UGVybWlzc2lvbltdXG4gIHByaXZhdGUgb25SZWFkeUNhbGxiYWNrPzogKCkgPT4gdm9pZFxuICBwcml2YXRlIGNvbXBvbmVudDogQ29tcG9uZW50ID0geyBhY3RpdmVUaGVtZXM6IFtdLCBhY2NlcHRzVGhlbWVzOiB0cnVlIH1cbiAgcHJpdmF0ZSBzZW50TWVzc2FnZXM6IE1lc3NhZ2VQYXlsb2FkW10gPSBbXVxuICBwcml2YXRlIG1lc3NhZ2VRdWV1ZTogTWVzc2FnZVBheWxvYWRbXSA9IFtdXG4gIHByaXZhdGUgbGFzdFN0cmVhbWVkSXRlbT86IEl0ZW1QYXlsb2FkXG4gIHByaXZhdGUgcGVuZGluZ1NhdmVJdGVtcz86IEl0ZW1QYXlsb2FkW11cbiAgcHJpdmF0ZSBwZW5kaW5nU2F2ZVRpbWVvdXQ/OiBOb2RlSlMuVGltZW91dFxuICBwcml2YXRlIHBlbmRpbmdTYXZlUGFyYW1zPzogYW55XG4gIHByaXZhdGUgY29hbGxlc2VkU2F2aW5nID0gdHJ1ZVxuICBwcml2YXRlIGNvYWxsZXNlZFNhdmluZ0RlbGF5ID0gREVGQVVMVF9DT0FMTEVTRURfU0FWSU5HX0RFTEFZXG4gIHByaXZhdGUgbWVzc2FnZUhhbmRsZXI/OiAoZXZlbnQ6IGFueSkgPT4gdm9pZFxuICBwcml2YXRlIGtleURvd25FdmVudExpc3RlbmVyPzogKGV2ZW50OiBLZXlib2FyZEV2ZW50KSA9PiB2b2lkXG4gIHByaXZhdGUga2V5VXBFdmVudExpc3RlbmVyPzogKGV2ZW50OiBLZXlib2FyZEV2ZW50KSA9PiB2b2lkXG4gIHByaXZhdGUgY2xpY2tFdmVudExpc3RlbmVyPzogKGV2ZW50OiBNb3VzZUV2ZW50KSA9PiB2b2lkXG4gIHByaXZhdGUgb25UaGVtZXNDaGFuZ2VDYWxsYmFjaz86ICgpID0+IHZvaWRcbiAgcHJpdmF0ZSBjb25jZXJuVGltZW91dHM6IE5vZGVKUy5UaW1lb3V0W10gPSBbXVxuXG4gIGNvbnN0cnVjdG9yKHBhcmFtczogQ29tcG9uZW50UmVsYXlQYXJhbXMpIHtcbiAgICBpZiAoIXBhcmFtcyB8fCAhcGFyYW1zLnRhcmdldFdpbmRvdykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdjb250ZW50V2luZG93IG11c3QgYmUgYSB2YWxpZCBXaW5kb3cgb2JqZWN0LicpXG4gICAgfVxuICAgIHRoaXMuY29udGVudFdpbmRvdyA9IHBhcmFtcy50YXJnZXRXaW5kb3dcbiAgICB0aGlzLnByb2Nlc3NQYXJhbWV0ZXJzKHBhcmFtcylcbiAgICB0aGlzLnJlZ2lzdGVyTWVzc2FnZUhhbmRsZXIoKVxuICAgIHRoaXMucmVnaXN0ZXJLZXlib2FyZEV2ZW50TGlzdGVuZXJzKClcbiAgICB0aGlzLnJlZ2lzdGVyTW91c2VFdmVudExpc3RlbmVycygpXG4gIH1cblxuICBwcml2YXRlIHByb2Nlc3NQYXJhbWV0ZXJzKHBhcmFtczogQ29tcG9uZW50UmVsYXlQYXJhbXMpIHtcbiAgICBjb25zdCB7IGluaXRpYWxQZXJtaXNzaW9ucywgb3B0aW9ucywgb25SZWFkeSwgb25UaGVtZXNDaGFuZ2UgfSA9IHBhcmFtc1xuXG4gICAgaWYgKGluaXRpYWxQZXJtaXNzaW9ucyAmJiBpbml0aWFsUGVybWlzc2lvbnMubGVuZ3RoID4gMCkge1xuICAgICAgdGhpcy5pbml0aWFsUGVybWlzc2lvbnMgPSBpbml0aWFsUGVybWlzc2lvbnNcbiAgICB9XG5cbiAgICBpZiAoaXNOb3RVbmRlZmluZWRPck51bGwob3B0aW9ucz8uY29hbGxlc2VkU2F2aW5nKSkge1xuICAgICAgdGhpcy5jb2FsbGVzZWRTYXZpbmcgPSBvcHRpb25zIS5jb2FsbGVzZWRTYXZpbmchXG4gICAgfVxuICAgIGlmIChpc05vdFVuZGVmaW5lZE9yTnVsbChvcHRpb25zPy5jb2FsbGVzZWRTYXZpbmdEZWxheSkpIHtcbiAgICAgIHRoaXMuY29hbGxlc2VkU2F2aW5nRGVsYXkgPSBvcHRpb25zIS5jb2FsbGVzZWRTYXZpbmdEZWxheSFcbiAgICB9XG4gICAgaWYgKGlzTm90VW5kZWZpbmVkT3JOdWxsKG9wdGlvbnM/LmFjY2VwdHNUaGVtZXMpKSB7XG4gICAgICB0aGlzLmNvbXBvbmVudC5hY2NlcHRzVGhlbWVzID0gb3B0aW9ucz8uYWNjZXB0c1RoZW1lcyA/PyB0cnVlXG4gICAgfVxuICAgIGlmIChpc05vdFVuZGVmaW5lZE9yTnVsbChvblJlYWR5KSkge1xuICAgICAgdGhpcy5vblJlYWR5Q2FsbGJhY2sgPSBvblJlYWR5XG4gICAgfVxuICAgIGlmIChpc05vdFVuZGVmaW5lZE9yTnVsbChvblRoZW1lc0NoYW5nZSkpIHtcbiAgICAgIHRoaXMub25UaGVtZXNDaGFuZ2VDYWxsYmFjayA9IG9uVGhlbWVzQ2hhbmdlXG4gICAgfVxuXG4gICAgTG9nZ2VyLmVuYWJsZWQgPSBvcHRpb25zPy5kZWJ1ZyA/PyBmYWxzZVxuICB9XG5cbiAgcHVibGljIGRlaW5pdCgpOiB2b2lkIHtcbiAgICB0aGlzLm9uUmVhZHlDYWxsYmFjayA9IHVuZGVmaW5lZFxuICAgIHRoaXMuY29tcG9uZW50ID0ge1xuICAgICAgYWNjZXB0c1RoZW1lczogdHJ1ZSxcbiAgICAgIGFjdGl2ZVRoZW1lczogW10sXG4gICAgfVxuICAgIHRoaXMubWVzc2FnZVF1ZXVlID0gW11cbiAgICB0aGlzLnNlbnRNZXNzYWdlcyA9IFtdXG4gICAgdGhpcy5sYXN0U3RyZWFtZWRJdGVtID0gdW5kZWZpbmVkXG4gICAgdGhpcy5wZW5kaW5nU2F2ZUl0ZW1zID0gdW5kZWZpbmVkXG4gICAgdGhpcy5wZW5kaW5nU2F2ZVRpbWVvdXQgPSB1bmRlZmluZWRcbiAgICB0aGlzLnBlbmRpbmdTYXZlUGFyYW1zID0gdW5kZWZpbmVkXG5cbiAgICBpZiAodGhpcy5tZXNzYWdlSGFuZGxlcikge1xuICAgICAgdGhpcy5jb250ZW50V2luZG93LmRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXG4gICAgICAgICdtZXNzYWdlJyxcbiAgICAgICAgdGhpcy5tZXNzYWdlSGFuZGxlcixcbiAgICAgIClcbiAgICAgIHRoaXMuY29udGVudFdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgdGhpcy5tZXNzYWdlSGFuZGxlcilcbiAgICB9XG5cbiAgICBpZiAodGhpcy5rZXlEb3duRXZlbnRMaXN0ZW5lcikge1xuICAgICAgdGhpcy5jb250ZW50V2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXG4gICAgICAgICdrZXlkb3duJyxcbiAgICAgICAgdGhpcy5rZXlEb3duRXZlbnRMaXN0ZW5lcixcbiAgICAgIClcbiAgICB9XG5cbiAgICBpZiAodGhpcy5rZXlVcEV2ZW50TGlzdGVuZXIpIHtcbiAgICAgIHRoaXMuY29udGVudFdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXl1cCcsIHRoaXMua2V5VXBFdmVudExpc3RlbmVyKVxuICAgIH1cblxuICAgIGlmICh0aGlzLmNsaWNrRXZlbnRMaXN0ZW5lcikge1xuICAgICAgdGhpcy5jb250ZW50V2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5jbGlja0V2ZW50TGlzdGVuZXIpXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSByZWdpc3Rlck1lc3NhZ2VIYW5kbGVyKCkge1xuICAgIHRoaXMubWVzc2FnZUhhbmRsZXIgPSAoZXZlbnQ6IE1lc3NhZ2VFdmVudCkgPT4ge1xuICAgICAgTG9nZ2VyLmluZm8oJ0NvbXBvbmVudHMgQVBJIE1lc3NhZ2UgcmVjZWl2ZWQ6JywgZXZlbnQuZGF0YSlcblxuICAgICAgLyoqXG4gICAgICAgKiBXZSBkb24ndCBoYXZlIGFjY2VzcyB0byB3aW5kb3cucGFyZW50Lm9yaWdpbiBkdWUgdG8gY3Jvc3MtZG9tYWluIHJlc3RyaWN0aW9ucy5cbiAgICAgICAqIENoZWNrIHJlZmVycmVyIGlmIGF2YWlsYWJsZSwgb3RoZXJ3aXNlIGRlZmVyIHRvIGNoZWNraW5nIGZvciBmaXJzdC1ydW4gdmFsdWUuXG4gICAgICAgKiBDcmFmdCBVUkwgb2JqZWN0cyBzbyB0aGF0IGV4YW1wbGUuY29tID09PSBleGFtcGxlLmNvbS9cbiAgICAgICAqL1xuICAgICAgaWYgKGRvY3VtZW50LnJlZmVycmVyKSB7XG4gICAgICAgIGNvbnN0IHJlZmVycmVyID0gbmV3IFVSTChkb2N1bWVudC5yZWZlcnJlcikub3JpZ2luXG4gICAgICAgIGNvbnN0IGV2ZW50T3JpZ2luID0gbmV3IFVSTChldmVudC5vcmlnaW4pLm9yaWdpblxuXG4gICAgICAgIGlmIChyZWZlcnJlciAhPT0gZXZlbnRPcmlnaW4pIHtcbiAgICAgICAgICByZXR1cm5cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBNb2JpbGUgZW52aXJvbm1lbnQgc2VuZHMgZGF0YSBhcyBKU09OIHN0cmluZy5cbiAgICAgIGNvbnN0IHsgZGF0YSB9ID0gZXZlbnRcbiAgICAgIGNvbnN0IHBhcnNlZERhdGEgPSBpc1ZhbGlkSnNvblN0cmluZyhkYXRhKSA/IEpTT04ucGFyc2UoZGF0YSkgOiBkYXRhXG5cbiAgICAgIGlmICghcGFyc2VkRGF0YSkge1xuICAgICAgICBMb2dnZXIuZXJyb3IoJ0ludmFsaWQgZGF0YSByZWNlaXZlZC4gU2tpcHBpbmcuLi4nKVxuICAgICAgICByZXR1cm5cbiAgICAgIH1cblxuICAgICAgLyoqXG4gICAgICAgKiBUaGUgQ29tcG9uZW50IFJlZ2lzdGVyZWQgbWVzc2FnZSB3aWxsIGJlIHRoZSBtb3N0IHJlbGlhYmxlIG9uZSwgc28gd2Ugd29uJ3QgY2hhbmdlIGl0IGFmdGVyIGFueSBzdWJzZXF1ZW50IGV2ZW50cyxcbiAgICAgICAqIGluIGNhc2UgeW91IHJlY2VpdmUgYW4gZXZlbnQgZnJvbSBhbm90aGVyIHdpbmRvdy5cbiAgICAgICAqL1xuICAgICAgaWYgKFxuICAgICAgICB0eXBlb2YgdGhpcy5jb21wb25lbnQub3JpZ2luID09PSAndW5kZWZpbmVkJyAmJlxuICAgICAgICBwYXJzZWREYXRhLmFjdGlvbiA9PT0gQ29tcG9uZW50QWN0aW9uLkNvbXBvbmVudFJlZ2lzdGVyZWRcbiAgICAgICkge1xuICAgICAgICB0aGlzLmNvbXBvbmVudC5vcmlnaW4gPSBldmVudC5vcmlnaW5cbiAgICAgIH0gZWxzZSBpZiAoZXZlbnQub3JpZ2luICE9PSB0aGlzLmNvbXBvbmVudC5vcmlnaW4pIHtcbiAgICAgICAgLy8gSWYgZXZlbnQgb3JpZ2luIGRvZXNuJ3QgbWF0Y2ggZmlyc3QtcnVuIHZhbHVlLCByZXR1cm4uXG4gICAgICAgIHJldHVyblxuICAgICAgfVxuXG4gICAgICB0aGlzLmhhbmRsZU1lc3NhZ2UocGFyc2VkRGF0YSlcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBNb2JpbGUgKFJlYWN0IE5hdGl2ZSkgdXNlcyBgZG9jdW1lbnRgLCB3ZWIvZGVza3RvcCB1c2VzIGB3aW5kb3dgLmFkZEV2ZW50TGlzdGVuZXJcbiAgICAgKiBmb3IgcG9zdE1lc3NhZ2UgQVBJIHRvIHdvcmsgcHJvcGVybHkuXG4gICAgICogVXBkYXRlIE1heSAyMDE5OlxuICAgICAqIEFzIHBhcnQgb2YgdHJhbnNpdGlvbmluZyBSZWFjdCBOYXRpdmUgd2VidmlldyBpbnRvIHRoZSBjb21tdW5pdHkgcGFja2FnZSxcbiAgICAgKiB3ZSdsbCBub3cgb25seSBuZWVkIHRvIHVzZSB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lci5cbiAgICAgKiBIb3dldmVyLCB3ZSB3YW50IHRvIG1haW50YWluIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkgZm9yIE1vYmlsZSA8IHYzLjAuNSwgc28gd2UnbGwga2VlcCBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyXG4gICAgICogQWxzbywgZXZlbiB3aXRoIHRoZSBuZXcgdmVyc2lvbiBvZiByZWFjdC1uYXRpdmUtd2VidmlldywgQW5kcm9pZCBtYXkgc3RpbGwgcmVxdWlyZSBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyICh3aGlsZSBpT1Mgc3RpbGwgb25seSByZXF1aXJlcyB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcilcbiAgICAgKiBodHRwczovL2dpdGh1Yi5jb20vcmVhY3QtbmF0aXZlLWNvbW11bml0eS9yZWFjdC1uYXRpdmUtd2Vidmlldy9pc3N1ZXMvMzIzI2lzc3VlY29tbWVudC00Njc3Njc5MzNcbiAgICAgKi9cbiAgICB0aGlzLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgICdtZXNzYWdlJyxcbiAgICAgIHRoaXMubWVzc2FnZUhhbmRsZXIsXG4gICAgICBmYWxzZSxcbiAgICApXG4gICAgdGhpcy5jb250ZW50V2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCB0aGlzLm1lc3NhZ2VIYW5kbGVyLCBmYWxzZSlcblxuICAgIExvZ2dlci5pbmZvKCdXYWl0aW5nIGZvciBtZXNzYWdlcy4uLicpXG4gIH1cblxuICBwcml2YXRlIHJlZ2lzdGVyS2V5Ym9hcmRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLmtleURvd25FdmVudExpc3RlbmVyID0gKGV2ZW50OiBLZXlib2FyZEV2ZW50KSA9PiB7XG4gICAgICBMb2dnZXIuaW5mbyhgQSBrZXkgaGFzIGJlZW4gcHJlc3NlZDogJHtldmVudC5rZXl9YClcblxuICAgICAgaWYgKGV2ZW50LmN0cmxLZXkpIHtcbiAgICAgICAgdGhpcy5rZXlEb3duRXZlbnQoS2V5Ym9hcmRNb2RpZmllci5DdHJsKVxuICAgICAgfSBlbHNlIGlmIChldmVudC5zaGlmdEtleSkge1xuICAgICAgICB0aGlzLmtleURvd25FdmVudChLZXlib2FyZE1vZGlmaWVyLlNoaWZ0KVxuICAgICAgfSBlbHNlIGlmIChldmVudC5tZXRhS2V5IHx8IGV2ZW50LmtleSA9PT0gJ01ldGEnKSB7XG4gICAgICAgIHRoaXMua2V5RG93bkV2ZW50KEtleWJvYXJkTW9kaWZpZXIuTWV0YSlcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLmtleVVwRXZlbnRMaXN0ZW5lciA9IChldmVudDogS2V5Ym9hcmRFdmVudCkgPT4ge1xuICAgICAgTG9nZ2VyLmluZm8oYEEga2V5IGhhcyBiZWVuIHJlbGVhc2VkOiAke2V2ZW50LmtleX1gKVxuXG4gICAgICAvKipcbiAgICAgICAqIENoZWNraW5nIHVzaW5nIGV2ZW50LmtleSBpbnN0ZWFkIG9mIHRoZSBjb3JyZXNwb25kaW5nIGJvb2xlYW4gcHJvcGVydGllcy5cbiAgICAgICAqL1xuICAgICAgaWYgKGV2ZW50LmtleSA9PT0gJ0NvbnRyb2wnKSB7XG4gICAgICAgIHRoaXMua2V5VXBFdmVudChLZXlib2FyZE1vZGlmaWVyLkN0cmwpXG4gICAgICB9IGVsc2UgaWYgKGV2ZW50LmtleSA9PT0gJ1NoaWZ0Jykge1xuICAgICAgICB0aGlzLmtleVVwRXZlbnQoS2V5Ym9hcmRNb2RpZmllci5TaGlmdClcbiAgICAgIH0gZWxzZSBpZiAoZXZlbnQua2V5ID09PSAnTWV0YScpIHtcbiAgICAgICAgdGhpcy5rZXlVcEV2ZW50KEtleWJvYXJkTW9kaWZpZXIuTWV0YSlcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLmNvbnRlbnRXaW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgICdrZXlkb3duJyxcbiAgICAgIHRoaXMua2V5RG93bkV2ZW50TGlzdGVuZXIsXG4gICAgICBmYWxzZSxcbiAgICApXG4gICAgdGhpcy5jb250ZW50V2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgdGhpcy5rZXlVcEV2ZW50TGlzdGVuZXIsIGZhbHNlKVxuICB9XG5cbiAgcHJpdmF0ZSByZWdpc3Rlck1vdXNlRXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5jbGlja0V2ZW50TGlzdGVuZXIgPSAoX2V2ZW50OiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICBMb2dnZXIuaW5mbygnQSBjbGljayBoYXMgYmVlbiBwZXJmb3JtZWQuJylcblxuICAgICAgdGhpcy5tb3VzZUNsaWNrRXZlbnQoKVxuICAgIH1cblxuICAgIHRoaXMuY29udGVudFdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuY2xpY2tFdmVudExpc3RlbmVyLCBmYWxzZSlcbiAgfVxuXG4gIHByaXZhdGUgaGFuZGxlTWVzc2FnZShwYXlsb2FkOiBNZXNzYWdlUGF5bG9hZCkge1xuICAgIHN3aXRjaCAocGF5bG9hZC5hY3Rpb24pIHtcbiAgICAgIGNhc2UgQ29tcG9uZW50QWN0aW9uLkNvbXBvbmVudFJlZ2lzdGVyZWQ6XG4gICAgICAgIHRoaXMuY29tcG9uZW50LnNlc3Npb25LZXkgPSBwYXlsb2FkLnNlc3Npb25LZXlcbiAgICAgICAgaWYgKHBheWxvYWQuY29tcG9uZW50RGF0YSkge1xuICAgICAgICAgIHRoaXMuY29tcG9uZW50LmRhdGEgPSBwYXlsb2FkLmNvbXBvbmVudERhdGFcbiAgICAgICAgfVxuICAgICAgICB0aGlzLm9uUmVhZHkocGF5bG9hZC5kYXRhKVxuICAgICAgICBMb2dnZXIuaW5mbygnQ29tcG9uZW50IHN1Y2Nlc3NmdWxseSByZWdpc3RlcmVkIHdpdGggcGF5bG9hZDonLCBwYXlsb2FkKVxuICAgICAgICBicmVha1xuXG4gICAgICBjYXNlIENvbXBvbmVudEFjdGlvbi5BY3RpdmF0ZVRoZW1lczpcbiAgICAgICAgdGhpcy5hY3RpdmF0ZVRoZW1lcyhwYXlsb2FkLmRhdGEudGhlbWVzKVxuICAgICAgICBicmVha1xuXG4gICAgICBkZWZhdWx0OiB7XG4gICAgICAgIGlmICghcGF5bG9hZC5vcmlnaW5hbCkge1xuICAgICAgICAgIHJldHVyblxuICAgICAgICB9XG5cbiAgICAgICAgLy8gR2V0IHRoZSBjYWxsYmFjayBmcm9tIHF1ZXVlLlxuICAgICAgICBjb25zdCBvcmlnaW5hbE1lc3NhZ2UgPSB0aGlzLnNlbnRNZXNzYWdlcz8uZmlsdGVyKFxuICAgICAgICAgIChtZXNzYWdlOiBNZXNzYWdlUGF5bG9hZCkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIG1lc3NhZ2UubWVzc2FnZUlkID09PSBwYXlsb2FkLm9yaWdpbmFsPy5tZXNzYWdlSWRcbiAgICAgICAgICB9LFxuICAgICAgICApWzBdXG5cbiAgICAgICAgaWYgKCFvcmlnaW5hbE1lc3NhZ2UpIHtcbiAgICAgICAgICAvLyBDb25uZWN0aW9uIG11c3QgaGF2ZSBiZWVuIHJlc2V0LiBXZSBzaG91bGQgYWxlcnQgdGhlIHVzZXIgdW5sZXNzIGl0J3MgYSByZXBseSxcbiAgICAgICAgICAvLyBpbiB3aGljaCBjYXNlIHdlIG1heSBoYXZlIGJlZW4gZGVhbGxvY2F0ZWQgYW5kIHJlaW5pdGlhbGl6ZWQgYW5kIGxvc3QgdGhlXG4gICAgICAgICAgLy8gb3JpZ2luYWwgbWVzc2FnZVxuICAgICAgICAgIGNvbnN0IGV4dGVuc2lvbk5hbWUgPSB0aGlzLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQudGl0bGVcbiAgICAgICAgICBjb25zdCBhbGVydE1lc3NhZ2UgPSAoXG4gICAgICAgICAgICBgVGhlIGV4dGVuc2lvbiAnJHtleHRlbnNpb25OYW1lfScgaXMgYXR0ZW1wdGluZyB0byBjb21tdW5pY2F0ZSB3aXRoIFN0YW5kYXJkIE5vdGVzLCBgICtcbiAgICAgICAgICAgICdidXQgYW4gZXJyb3IgaXMgcHJldmVudGluZyBpdCBmcm9tIGRvaW5nIHNvLiBQbGVhc2UgcmVzdGFydCB0aGlzIGV4dGVuc2lvbiBhbmQgdHJ5IGFnYWluLidcbiAgICAgICAgICApLnJlcGxhY2UoJyAgJywgJyAnKVxuXG4gICAgICAgICAgTG9nZ2VyLmluZm8oYWxlcnRNZXNzYWdlKVxuICAgICAgICAgIHJldHVyblxuICAgICAgICB9XG5cbiAgICAgICAgb3JpZ2luYWxNZXNzYWdlPy5jYWxsYmFjaz8uKHBheWxvYWQuZGF0YSlcbiAgICAgICAgYnJlYWtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBwcml2YXRlIG9uUmVhZHkoZGF0YTogTWVzc2FnZURhdGEpIHtcbiAgICB0aGlzLmNvbXBvbmVudC5lbnZpcm9ubWVudCA9IGRhdGEuZW52aXJvbm1lbnRcbiAgICB0aGlzLmNvbXBvbmVudC5wbGF0Zm9ybSA9IGRhdGEucGxhdGZvcm1cbiAgICB0aGlzLmNvbXBvbmVudC51dWlkID0gZGF0YS51dWlkXG5cbiAgICBpZiAodGhpcy5pbml0aWFsUGVybWlzc2lvbnMgJiYgdGhpcy5pbml0aWFsUGVybWlzc2lvbnMubGVuZ3RoID4gMCkge1xuICAgICAgdGhpcy5yZXF1ZXN0UGVybWlzc2lvbnModGhpcy5pbml0aWFsUGVybWlzc2lvbnMpXG4gICAgfVxuXG4gICAgZm9yIChjb25zdCBtZXNzYWdlIG9mIHRoaXMubWVzc2FnZVF1ZXVlKSB7XG4gICAgICB0aGlzLnBvc3RNZXNzYWdlKG1lc3NhZ2UuYWN0aW9uLCBtZXNzYWdlLmRhdGEsIG1lc3NhZ2UuY2FsbGJhY2spXG4gICAgfVxuXG4gICAgdGhpcy5tZXNzYWdlUXVldWUgPSBbXVxuXG4gICAgTG9nZ2VyLmluZm8oJ0RhdGEgcGFzc2VkIHRvIG9uUmVhZHk6JywgZGF0YSlcblxuICAgIHRoaXMuYWN0aXZhdGVUaGVtZXMoZGF0YS5hY3RpdmVUaGVtZVVybHMgfHwgW10pXG5cbiAgICAvLyBBZnRlciBhY3RpdmF0ZVRoZW1lcyBpcyBkb25lLCB3ZSB3YW50IHRvIHNlbmQgYSBtZXNzYWdlIHdpdGggdGhlIFRoZW1lc0FjdGl2YXRlZCBhY3Rpb24uXG4gICAgdGhpcy5wb3N0TWVzc2FnZShDb21wb25lbnRBY3Rpb24uVGhlbWVzQWN0aXZhdGVkLCB7fSlcblxuICAgIGlmICh0aGlzLm9uUmVhZHlDYWxsYmFjaykge1xuICAgICAgdGhpcy5vblJlYWR5Q2FsbGJhY2soKVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBjb21wb25lbnQgVVVJRC5cbiAgICovXG4gIHB1YmxpYyBnZXRTZWxmQ29tcG9uZW50VVVJRCgpOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLmNvbXBvbmVudC51dWlkXG4gIH1cblxuICAvKipcbiAgICogQ2hlY2tzIGlmIHRoZSBjb21wb25lbnQgaXMgcnVubmluZyBpbiBhIERlc2t0b3AgYXBwbGljYXRpb24uXG4gICAqL1xuICBwdWJsaWMgaXNSdW5uaW5nSW5EZXNrdG9wQXBwbGljYXRpb24oKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIChcbiAgICAgIHRoaXMuY29tcG9uZW50LmVudmlyb25tZW50ID09PSBlbnZpcm9ubWVudFRvU3RyaW5nKEVudmlyb25tZW50LkRlc2t0b3ApXG4gICAgKVxuICB9XG5cbiAgLyoqXG4gICAqIENoZWNrcyBpZiB0aGUgY29tcG9uZW50IGlzIHJ1bm5pbmcgaW4gYSBNb2JpbGUgYXBwbGljYXRpb24uXG4gICAqL1xuICBwdWJsaWMgaXNSdW5uaW5nSW5Nb2JpbGVBcHBsaWNhdGlvbigpOiBib29sZWFuIHtcbiAgICByZXR1cm4gKFxuICAgICAgdGhpcy5jb21wb25lbnQuZW52aXJvbm1lbnQgPT09IGVudmlyb25tZW50VG9TdHJpbmcoRW52aXJvbm1lbnQuTW9iaWxlKVxuICAgIClcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBjb21wb25lbnQncyBkYXRhIHZhbHVlIGZvciB0aGUgc3BlY2lmaWVkIGtleS5cbiAgICogQHBhcmFtIGtleSBUaGUga2V5IGZvciB0aGUgZGF0YSBvYmplY3QuXG4gICAqIEByZXR1cm5zIGB1bmRlZmluZWRgIGlmIHRoZSB2YWx1ZSBmb3IgdGhlIGtleSBkb2VzIG5vdCBleGlzdC4gUmV0dXJucyB0aGUgc3RvcmVkIHZhbHVlIG90aGVyd2lzZS5cbiAgICovXG4gIHB1YmxpYyBnZXRDb21wb25lbnREYXRhVmFsdWVGb3JLZXkoa2V5OiBzdHJpbmcpOiBhbnkge1xuICAgIGlmICghdGhpcy5jb21wb25lbnQuZGF0YSkge1xuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIHJldHVybiB0aGlzLmNvbXBvbmVudC5kYXRhW2tleV1cbiAgfVxuXG4gIC8qKlxuICAgKiBTZXRzIHRoZSBjb21wb25lbnQncyBkYXRhIHZhbHVlIGZvciB0aGUgc3BlY2lmaWVkIGtleS5cbiAgICogQHBhcmFtIGtleSBUaGUga2V5IGZvciB0aGUgZGF0YSBvYmplY3QuXG4gICAqIEBwYXJhbSB2YWx1ZSBUaGUgdmFsdWUgdG8gc3RvcmUgdW5kZXIgdGhlIHNwZWNpZmllZCBrZXkuXG4gICAqL1xuICBwdWJsaWMgc2V0Q29tcG9uZW50RGF0YVZhbHVlRm9yS2V5KGtleTogc3RyaW5nLCB2YWx1ZTogYW55KTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLmNvbXBvbmVudC5kYXRhKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZSBjb21wb25lbnQgaGFzIG5vdCBiZWVuIGluaXRpYWxpemVkLicpXG4gICAgfVxuICAgIGlmICgha2V5IHx8IChrZXkgJiYga2V5Lmxlbmd0aCA9PT0gMCkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignVGhlIGtleSBmb3IgdGhlIGRhdGEgdmFsdWUgc2hvdWxkIGJlIGEgdmFsaWQgc3RyaW5nLicpXG4gICAgfVxuICAgIHRoaXMuY29tcG9uZW50LmRhdGEgPSB7XG4gICAgICAuLi50aGlzLmNvbXBvbmVudC5kYXRhLFxuICAgICAgW2tleV06IHZhbHVlLFxuICAgIH1cbiAgICB0aGlzLnBvc3RNZXNzYWdlKENvbXBvbmVudEFjdGlvbi5TZXRDb21wb25lbnREYXRhLCB7XG4gICAgICBjb21wb25lbnREYXRhOiB0aGlzLmNvbXBvbmVudC5kYXRhLFxuICAgIH0pXG4gIH1cblxuICAvKipcbiAgICogQ2xlYXJzIHRoZSBjb21wb25lbnQncyBkYXRhIG9iamVjdC5cbiAgICovXG4gIHB1YmxpYyBjbGVhckNvbXBvbmVudERhdGEoKTogdm9pZCB7XG4gICAgdGhpcy5jb21wb25lbnQuZGF0YSA9IHt9XG4gICAgdGhpcy5wb3N0TWVzc2FnZShDb21wb25lbnRBY3Rpb24uU2V0Q29tcG9uZW50RGF0YSwge1xuICAgICAgY29tcG9uZW50RGF0YTogdGhpcy5jb21wb25lbnQuZGF0YSxcbiAgICB9KVxuICB9XG5cbiAgcHJpdmF0ZSBwb3N0TWVzc2FnZShcbiAgICBhY3Rpb246IENvbXBvbmVudEFjdGlvbixcbiAgICBkYXRhOiBNZXNzYWdlRGF0YSxcbiAgICBjYWxsYmFjaz86ICguLi5wYXJhbXM6IGFueSkgPT4gdm9pZCxcbiAgKSB7XG4gICAgLyoqXG4gICAgICogSWYgdGhlIHNlc3Npb25LZXkgaXMgbm90IHNldCwgd2UgcHVzaCB0aGUgbWVzc2FnZSB0byBxdWV1ZVxuICAgICAqIHRoYXQgd2lsbCBiZSBwcm9jZXNzZWQgbGF0ZXIgb24uXG4gICAgICovXG4gICAgaWYgKCF0aGlzLmNvbXBvbmVudC5zZXNzaW9uS2V5KSB7XG4gICAgICB0aGlzLm1lc3NhZ2VRdWV1ZS5wdXNoKHtcbiAgICAgICAgYWN0aW9uLFxuICAgICAgICBkYXRhLFxuICAgICAgICBhcGk6IE1lc3NhZ2VQYXlsb2FkQXBpLkNvbXBvbmVudCxcbiAgICAgICAgY2FsbGJhY2s6IGNhbGxiYWNrLFxuICAgICAgfSlcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIGNvbnN0IG1lc3NhZ2UgPSB7XG4gICAgICBhY3Rpb24sXG4gICAgICBkYXRhLFxuICAgICAgbWVzc2FnZUlkOiB0aGlzLmdlbmVyYXRlVVVJRCgpLFxuICAgICAgc2Vzc2lvbktleTogdGhpcy5jb21wb25lbnQuc2Vzc2lvbktleSxcbiAgICAgIGFwaTogTWVzc2FnZVBheWxvYWRBcGkuQ29tcG9uZW50LFxuICAgIH1cblxuICAgIGNvbnN0IHNlbnRNZXNzYWdlID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShtZXNzYWdlKSlcbiAgICBzZW50TWVzc2FnZS5jYWxsYmFjayA9IGNhbGxiYWNrXG4gICAgdGhpcy5zZW50TWVzc2FnZXMucHVzaChzZW50TWVzc2FnZSlcblxuICAgIGxldCBwb3N0TWVzc2FnZVBheWxvYWRcblxuICAgIC8vIE1vYmlsZSAoUmVhY3QgTmF0aXZlKSByZXF1aXJlcyBhIHN0cmluZyBmb3IgdGhlIHBvc3RNZXNzYWdlIEFQSS5cbiAgICBpZiAodGhpcy5pc1J1bm5pbmdJbk1vYmlsZUFwcGxpY2F0aW9uKCkpIHtcbiAgICAgIHBvc3RNZXNzYWdlUGF5bG9hZCA9IEpTT04uc3RyaW5naWZ5KG1lc3NhZ2UpXG4gICAgfSBlbHNlIHtcbiAgICAgIHBvc3RNZXNzYWdlUGF5bG9hZCA9IG1lc3NhZ2VcbiAgICB9XG5cbiAgICBMb2dnZXIuaW5mbygnUG9zdGluZyBtZXNzYWdlOicsIHBvc3RNZXNzYWdlUGF5bG9hZClcbiAgICB0aGlzLmNvbnRlbnRXaW5kb3cucGFyZW50LnBvc3RNZXNzYWdlKFxuICAgICAgcG9zdE1lc3NhZ2VQYXlsb2FkLFxuICAgICAgdGhpcy5jb21wb25lbnQub3JpZ2luISxcbiAgICApXG4gIH1cblxuICBwcml2YXRlIHJlcXVlc3RQZXJtaXNzaW9ucyhcbiAgICBwZXJtaXNzaW9uczogQ29tcG9uZW50UGVybWlzc2lvbltdLFxuICAgIGNhbGxiYWNrPzogKC4uLnBhcmFtczogYW55KSA9PiB2b2lkLFxuICApIHtcbiAgICB0aGlzLnBvc3RNZXNzYWdlKFxuICAgICAgQ29tcG9uZW50QWN0aW9uLlJlcXVlc3RQZXJtaXNzaW9ucyxcbiAgICAgIHsgcGVybWlzc2lvbnMgfSxcbiAgICAgICgpID0+IHtcbiAgICAgICAgY2FsbGJhY2sgJiYgY2FsbGJhY2soKVxuICAgICAgfSxcbiAgICApXG4gIH1cblxuICBwcml2YXRlIGFjdGl2YXRlVGhlbWVzKGluY29taW5nVXJsczogc3RyaW5nW10gPSBbXSkge1xuICAgIGlmICghdGhpcy5jb21wb25lbnQuYWNjZXB0c1RoZW1lcykge1xuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgTG9nZ2VyLmluZm8oJ0luY29taW5nIHRoZW1lczonLCBpbmNvbWluZ1VybHMpXG5cbiAgICBjb25zdCB7IGFjdGl2ZVRoZW1lcyB9ID0gdGhpcy5jb21wb25lbnRcblxuICAgIGlmIChcbiAgICAgIGFjdGl2ZVRoZW1lcyAmJlxuICAgICAgYWN0aXZlVGhlbWVzLnNvcnQoKS50b1N0cmluZygpID09IGluY29taW5nVXJscy5zb3J0KCkudG9TdHJpbmcoKVxuICAgICkge1xuICAgICAgLy8gSW5jb21pbmcgdGhlbWUgVVJMcyBhcmUgc2FtZSBhcyBhY3RpdmUsIGRvIG5vdGhpbmcuXG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICBsZXQgdGhlbWVzVG9BY3RpdmF0ZSA9IGluY29taW5nVXJsc1xuICAgIGNvbnN0IHRoZW1lc1RvRGVhY3RpdmF0ZSA9IFtdXG5cbiAgICBmb3IgKGNvbnN0IGFjdGl2ZVVybCBvZiBhY3RpdmVUaGVtZXMpIHtcbiAgICAgIGlmICghaW5jb21pbmdVcmxzLmluY2x1ZGVzKGFjdGl2ZVVybCkpIHtcbiAgICAgICAgLy8gQWN0aXZlIG5vdCBwcmVzZW50IGluIGluY29taW5nLCBkZWFjdGl2YXRlIGl0LlxuICAgICAgICB0aGVtZXNUb0RlYWN0aXZhdGUucHVzaChhY3RpdmVVcmwpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBBbHJlYWR5IHByZXNlbnQgaW4gYWN0aXZlIHRoZW1lcywgcmVtb3ZlIGl0IGZyb20gdGhlbWVzVG9BY3RpdmF0ZS5cbiAgICAgICAgdGhlbWVzVG9BY3RpdmF0ZSA9IHRoZW1lc1RvQWN0aXZhdGUuZmlsdGVyKChjYW5kaWRhdGUpID0+IHtcbiAgICAgICAgICByZXR1cm4gY2FuZGlkYXRlICE9PSBhY3RpdmVVcmxcbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICB9XG5cbiAgICBMb2dnZXIuaW5mbygnRGVhY3RpdmF0aW5nIHRoZW1lczonLCB0aGVtZXNUb0RlYWN0aXZhdGUpXG4gICAgTG9nZ2VyLmluZm8oJ0FjdGl2YXRpbmcgdGhlbWVzOicsIHRoZW1lc1RvQWN0aXZhdGUpXG5cbiAgICBmb3IgKGNvbnN0IHRoZW1lVXJsIG9mIHRoZW1lc1RvRGVhY3RpdmF0ZSkge1xuICAgICAgdGhpcy5kZWFjdGl2YXRlVGhlbWUodGhlbWVVcmwpXG4gICAgfVxuXG4gICAgdGhpcy5jb21wb25lbnQuYWN0aXZlVGhlbWVzID0gaW5jb21pbmdVcmxzXG5cbiAgICBmb3IgKGNvbnN0IHRoZW1lVXJsIG9mIHRoZW1lc1RvQWN0aXZhdGUpIHtcbiAgICAgIGlmICghdGhlbWVVcmwpIHtcbiAgICAgICAgY29udGludWVcbiAgICAgIH1cblxuICAgICAgY29uc3QgbGluayA9IHRoaXMuY29udGVudFdpbmRvdy5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaW5rJylcbiAgICAgIGxpbmsuaWQgPSBidG9hKHRoZW1lVXJsKVxuICAgICAgbGluay5ocmVmID0gdGhlbWVVcmxcbiAgICAgIGxpbmsudHlwZSA9ICd0ZXh0L2NzcydcbiAgICAgIGxpbmsucmVsID0gJ3N0eWxlc2hlZXQnXG4gICAgICBsaW5rLm1lZGlhID0gJ3NjcmVlbixwcmludCdcbiAgICAgIGxpbmsuY2xhc3NOYW1lID0gJ2N1c3RvbS10aGVtZSdcbiAgICAgIHRoaXMuY29udGVudFdpbmRvdy5kb2N1bWVudFxuICAgICAgICAuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2hlYWQnKVswXVxuICAgICAgICAuYXBwZW5kQ2hpbGQobGluaylcbiAgICB9XG5cbiAgICB0aGlzLm9uVGhlbWVzQ2hhbmdlQ2FsbGJhY2sgJiYgdGhpcy5vblRoZW1lc0NoYW5nZUNhbGxiYWNrKClcbiAgfVxuXG4gIHByaXZhdGUgdGhlbWVFbGVtZW50Rm9yVXJsKHRoZW1lVXJsOiBzdHJpbmcpIHtcbiAgICBjb25zdCBlbGVtZW50cyA9IEFycmF5LmZyb20oXG4gICAgICB0aGlzLmNvbnRlbnRXaW5kb3cuZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnY3VzdG9tLXRoZW1lJyksXG4gICAgKS5zbGljZSgpXG4gICAgcmV0dXJuIGVsZW1lbnRzLmZpbmQoKGVsZW1lbnQpID0+IHtcbiAgICAgIC8vIFdlIHVzZWQgdG8gc2VhcmNoIGhlcmUgYnkgYGhyZWZgLCBidXQgb24gZGVza3RvcCwgd2l0aCBsb2NhbCBmaWxlOi8vIHVybHMsIHRoYXQgZGlkbid0IHdvcmsgZm9yIHNvbWUgcmVhc29uLlxuICAgICAgcmV0dXJuIGVsZW1lbnQuaWQgPT0gYnRvYSh0aGVtZVVybClcbiAgICB9KVxuICB9XG5cbiAgcHJpdmF0ZSBkZWFjdGl2YXRlVGhlbWUodGhlbWVVcmw6IHN0cmluZykge1xuICAgIGNvbnN0IGVsZW1lbnQgPSB0aGlzLnRoZW1lRWxlbWVudEZvclVybCh0aGVtZVVybClcbiAgICBpZiAoZWxlbWVudCAmJiBlbGVtZW50LnBhcmVudE5vZGUpIHtcbiAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICd0cnVlJylcbiAgICAgIGVsZW1lbnQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChlbGVtZW50KVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZ2VuZXJhdGVVVUlEKCkge1xuICAgIHJldHVybiBnZW5lcmF0ZVV1aWQoKVxuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIGN1cnJlbnQgcGxhdGZvcm0gd2hlcmUgdGhlIGNvbXBvbmVudCBpcyBydW5uaW5nLlxuICAgKi9cbiAgcHVibGljIGdldCBwbGF0Zm9ybSgpOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLmNvbXBvbmVudC5wbGF0Zm9ybVxuICB9XG5cbiAgLyoqXG4gICAqIEdldHMgdGhlIGN1cnJlbnQgZW52aXJvbm1lbnQgd2hlcmUgdGhlIGNvbXBvbmVudCBpcyBydW5uaW5nLlxuICAgKi9cbiAgcHVibGljIGdldCBlbnZpcm9ubWVudCgpOiBzdHJpbmcgfCB1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLmNvbXBvbmVudC5lbnZpcm9ubWVudFxuICB9XG5cbiAgLyoqXG4gICAqIFN0cmVhbXMgYSBjb2xsZWN0aW9uIG9mIEl0ZW1zLCBmaWx0ZXJlZCBieSBjb250ZW50IHR5cGUuXG4gICAqIE5ldyBpdGVtcyBhcmUgcGFzc2VkIHRvIHRoZSBjYWxsYmFjayBhcyB0aGV5IGNvbWUuXG4gICAqIEBwYXJhbSBjb250ZW50VHlwZXMgQSBjb2xsZWN0aW9uIG9mIENvbnRlbnQgVHlwZXMuXG4gICAqIEBwYXJhbSBjYWxsYmFjayBBIGNhbGxiYWNrIHRvIHByb2Nlc3MgdGhlIHN0cmVhbWVkIGl0ZW1zLlxuICAgKi9cbiAgcHVibGljIHN0cmVhbUl0ZW1zKFxuICAgIGNvbnRlbnRUeXBlczogQ29udGVudFR5cGVbXSxcbiAgICBjYWxsYmFjazogKGRhdGE6IGFueSkgPT4gdm9pZCxcbiAgKTogdm9pZCB7XG4gICAgdGhpcy5wb3N0TWVzc2FnZShcbiAgICAgIENvbXBvbmVudEFjdGlvbi5TdHJlYW1JdGVtcyxcbiAgICAgIHsgY29udGVudF90eXBlczogY29udGVudFR5cGVzIH0sXG4gICAgICAoZGF0YTogYW55KSA9PiB7XG4gICAgICAgIGNhbGxiYWNrKGRhdGEuaXRlbXMpXG4gICAgICB9LFxuICAgIClcbiAgfVxuXG4gIC8qKlxuICAgKiBTdHJlYW1zIHRoZSBjdXJyZW50IEl0ZW0gaW4gY29udGV4dC5cbiAgICogQHBhcmFtIGNhbGxiYWNrIEEgY2FsbGJhY2sgdG8gcHJvY2VzcyB0aGUgc3RyZWFtZWQgaXRlbS5cbiAgICovXG4gIHB1YmxpYyBzdHJlYW1Db250ZXh0SXRlbShjYWxsYmFjazogKGRhdGE6IGFueSkgPT4gdm9pZCk6IHZvaWQge1xuICAgIHRoaXMucG9zdE1lc3NhZ2UoQ29tcG9uZW50QWN0aW9uLlN0cmVhbUNvbnRleHRJdGVtLCB7fSwgKGRhdGEpID0+IHtcbiAgICAgIGNvbnN0IHsgaXRlbSB9ID0gZGF0YVxuICAgICAgLyoqXG4gICAgICAgKiBJZiB0aGlzIGlzIGEgbmV3IGNvbnRleHQgaXRlbSB0aGFuIHRoZSBjb250ZXh0IGl0ZW0gdGhlIGNvbXBvbmVudCB3YXMgY3VycmVudGx5IGVudGVydGFpbmluZyxcbiAgICAgICAqIHdlIHdhbnQgdG8gaW1tZWRpYXRlbHkgY29tbWl0IGFueSBwZW5kaW5nIHNhdmVzLCBiZWNhdXNlIGlmIHlvdSBzZW5kIHRoZSBuZXcgY29udGV4dCBpdGVtIHRvIHRoZVxuICAgICAgICogY29tcG9uZW50IGJlZm9yZSBpdCBoYXMgY29tbWl0ZWQgaXRzIHByZXNhdmUsIGl0IHdpbGwgZW5kIHVwIGZpcnN0IHJlcGxhY2luZyB0aGUgVUkgd2l0aCBuZXcgY29udGV4dCBpdGVtLFxuICAgICAgICogYW5kIHdoZW4gdGhlIGRlYm91bmNlciBleGVjdXRlcyB0byByZWFkIHRoZSBjb21wb25lbnQgVUksIGl0IHdpbGwgYmUgcmVhZGluZyB0aGUgbmV3IFVJIGZvciB0aGUgcHJldmlvdXMgaXRlbS5cbiAgICAgICAqL1xuICAgICAgY29uc3QgaXNOZXdJdGVtID1cbiAgICAgICAgIXRoaXMubGFzdFN0cmVhbWVkSXRlbSB8fCB0aGlzLmxhc3RTdHJlYW1lZEl0ZW0udXVpZCAhPT0gaXRlbS51dWlkXG5cbiAgICAgIGlmIChpc05ld0l0ZW0gJiYgdGhpcy5wZW5kaW5nU2F2ZVRpbWVvdXQpIHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMucGVuZGluZ1NhdmVUaW1lb3V0KVxuICAgICAgICB0aGlzLnBlcmZvcm1TYXZpbmdPZkl0ZW1zKHRoaXMucGVuZGluZ1NhdmVQYXJhbXMpXG4gICAgICAgIHRoaXMucGVuZGluZ1NhdmVUaW1lb3V0ID0gdW5kZWZpbmVkXG4gICAgICAgIHRoaXMucGVuZGluZ1NhdmVQYXJhbXMgPSB1bmRlZmluZWRcbiAgICAgIH1cblxuICAgICAgdGhpcy5sYXN0U3RyZWFtZWRJdGVtID0gaXRlbVxuICAgICAgY2FsbGJhY2sodGhpcy5sYXN0U3RyZWFtZWRJdGVtKVxuICAgIH0pXG4gIH1cblxuICAvKipcbiAgICogU2VsZWN0cyBhIGBUYWdgIGl0ZW0uXG4gICAqIEBwYXJhbSBpdGVtIFRoZSBJdGVtIChgVGFnYCBvciBgU21hcnRUYWdgKSB0byBzZWxlY3QuXG4gICAqL1xuICBwdWJsaWMgc2VsZWN0SXRlbShpdGVtOiBJdGVtUGF5bG9hZCk6IHZvaWQge1xuICAgIHRoaXMucG9zdE1lc3NhZ2UoQ29tcG9uZW50QWN0aW9uLlNlbGVjdEl0ZW0sIHtcbiAgICAgIGl0ZW06IHRoaXMuanNvbk9iamVjdEZvckl0ZW0oaXRlbSksXG4gICAgfSlcbiAgfVxuXG4gIC8qKlxuICAgKiBDbGVhcnMgY3VycmVudCBzZWxlY3RlZCBgVGFnYCAoaWYgYW55KS5cbiAgICovXG4gIHB1YmxpYyBjbGVhclNlbGVjdGlvbigpOiB2b2lkIHtcbiAgICB0aGlzLnBvc3RNZXNzYWdlKENvbXBvbmVudEFjdGlvbi5DbGVhclNlbGVjdGlvbiwge1xuICAgICAgY29udGVudF90eXBlOiBDb250ZW50VHlwZS5UYWcsXG4gICAgfSlcbiAgfVxuXG4gIC8qKlxuICAgKiBDcmVhdGVzIGFuZCBzdG9yZXMgYW4gSXRlbSBpbiB0aGUgaXRlbSBzdG9yZS5cbiAgICogQHBhcmFtIGl0ZW0gVGhlIEl0ZW0ncyBwYXlsb2FkIGNvbnRlbnQuXG4gICAqIEBwYXJhbSBjYWxsYmFjayBUaGUgY2FsbGJhY2sgdG8gcHJvY2VzcyB0aGUgY3JlYXRlZCBJdGVtLlxuICAgKi9cbiAgcHVibGljIGNyZWF0ZUl0ZW0oaXRlbTogSXRlbVBheWxvYWQsIGNhbGxiYWNrOiAoZGF0YTogYW55KSA9PiB2b2lkKTogdm9pZCB7XG4gICAgdGhpcy5wb3N0TWVzc2FnZShcbiAgICAgIENvbXBvbmVudEFjdGlvbi5DcmVhdGVJdGVtLFxuICAgICAgeyBpdGVtOiB0aGlzLmpzb25PYmplY3RGb3JJdGVtKGl0ZW0pIH0sXG4gICAgICAoZGF0YTogYW55KSA9PiB7XG4gICAgICAgIGxldCB7IGl0ZW0gfSA9IGRhdGFcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEEgcHJldmlvdXMgdmVyc2lvbiBvZiB0aGUgU04gYXBwIGhhZCBhbiBpc3N1ZSB3aGVyZSB0aGUgaXRlbSBpbiB0aGUgcmVwbHkgdG8gQ29tcG9uZW50QWN0aW9ucy5DcmVhdGVJdGVtc1xuICAgICAgICAgKiB3b3VsZCBiZSBuZXN0ZWQgaW5zaWRlIFwiaXRlbXNcIiBhbmQgbm90IFwiaXRlbVwiLiBTbyBoYW5kbGUgYm90aCBjYXNlcyBoZXJlLlxuICAgICAgICAgKi9cbiAgICAgICAgaWYgKCFpdGVtICYmIGRhdGEuaXRlbXMgJiYgZGF0YS5pdGVtcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgaXRlbSA9IGRhdGEuaXRlbXNbMF1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLmFzc29jaWF0ZUl0ZW0oaXRlbSlcbiAgICAgICAgY2FsbGJhY2sgJiYgY2FsbGJhY2soaXRlbSlcbiAgICAgIH0sXG4gICAgKVxuICB9XG5cbiAgLyoqXG4gICAqIENyZWF0ZXMgYW5kIHN0b3JlcyBhIGNvbGxlY3Rpb24gb2YgSXRlbXMgaW4gdGhlIGl0ZW0gc3RvcmUuXG4gICAqIEBwYXJhbSBpdGVtcyBUaGUgSXRlbShzKSBwYXlsb2FkIGNvbGxlY3Rpb24uXG4gICAqIEBwYXJhbSBjYWxsYmFjayBUaGUgY2FsbGJhY2sgdG8gcHJvY2VzcyB0aGUgY3JlYXRlZCBJdGVtKHMpLlxuICAgKi9cbiAgcHVibGljIGNyZWF0ZUl0ZW1zKFxuICAgIGl0ZW1zOiBJdGVtUGF5bG9hZFtdLFxuICAgIGNhbGxiYWNrOiAoZGF0YTogYW55KSA9PiB2b2lkLFxuICApOiB2b2lkIHtcbiAgICBjb25zdCBtYXBwZWQgPSBpdGVtcy5tYXAoKGl0ZW0pID0+IHRoaXMuanNvbk9iamVjdEZvckl0ZW0oaXRlbSkpXG4gICAgdGhpcy5wb3N0TWVzc2FnZShcbiAgICAgIENvbXBvbmVudEFjdGlvbi5DcmVhdGVJdGVtcyxcbiAgICAgIHsgaXRlbXM6IG1hcHBlZCB9LFxuICAgICAgKGRhdGE6IGFueSkgPT4ge1xuICAgICAgICBjYWxsYmFjayAmJiBjYWxsYmFjayhkYXRhLml0ZW1zKVxuICAgICAgfSxcbiAgICApXG4gIH1cblxuICAvKipcbiAgICogQXNzb2NpYXRlcyBhIGBUYWdgIHdpdGggdGhlIGN1cnJlbnQgTm90ZS5cbiAgICogQHBhcmFtIGl0ZW0gVGhlIGBUYWdgIGl0ZW0gdG8gYXNzb2NpYXRlLlxuICAgKi9cbiAgcHVibGljIGFzc29jaWF0ZUl0ZW0oaXRlbTogSXRlbVBheWxvYWQpOiB2b2lkIHtcbiAgICB0aGlzLnBvc3RNZXNzYWdlKENvbXBvbmVudEFjdGlvbi5Bc3NvY2lhdGVJdGVtLCB7XG4gICAgICBpdGVtOiB0aGlzLmpzb25PYmplY3RGb3JJdGVtKGl0ZW0pLFxuICAgIH0pXG4gIH1cblxuICAvKipcbiAgICogRGVhc3NvY2lhdGVzIGEgYFRhZ2Agd2l0aCB0aGUgY3VycmVudCBOb3RlLlxuICAgKiBAcGFyYW0gaXRlbSBUaGUgYFRhZ2AgaXRlbSB0byBkZWFzc29jaWF0ZS5cbiAgICovXG4gIHB1YmxpYyBkZWFzc29jaWF0ZUl0ZW0oaXRlbTogSXRlbVBheWxvYWQpOiB2b2lkIHtcbiAgICB0aGlzLnBvc3RNZXNzYWdlKENvbXBvbmVudEFjdGlvbi5EZWFzc29jaWF0ZUl0ZW0sIHtcbiAgICAgIGl0ZW06IHRoaXMuanNvbk9iamVjdEZvckl0ZW0oaXRlbSksXG4gICAgfSlcbiAgfVxuXG4gIC8qKlxuICAgKiBEZWxldGVzIGFuIEl0ZW0gZnJvbSB0aGUgaXRlbSBzdG9yZS5cbiAgICogQHBhcmFtIGl0ZW0gVGhlIEl0ZW0gdG8gZGVsZXRlLlxuICAgKiBAcGFyYW0gY2FsbGJhY2sgVGhlIGNhbGxiYWNrIHdpdGggdGhlIHJlc3VsdCBvZiB0aGUgb3BlcmF0aW9uLlxuICAgKi9cbiAgcHVibGljIGRlbGV0ZUl0ZW0oXG4gICAgaXRlbTogSXRlbVBheWxvYWQsXG4gICAgY2FsbGJhY2s6IChkYXRhOiBJdGVtTWVzc2FnZVBheWxvYWQpID0+IHZvaWQsXG4gICk6IHZvaWQge1xuICAgIHRoaXMuZGVsZXRlSXRlbXMoW2l0ZW1dLCBjYWxsYmFjaylcbiAgfVxuXG4gIC8qKlxuICAgKiBEZWxldGVzIGEgY29sbGVjdGlvbiBvZiBJdGVtcyBmcm9tIHRoZSBpdGVtIHN0b3JlLlxuICAgKiBAcGFyYW0gaXRlbXMgVGhlIEl0ZW0ocykgdG8gZGVsZXRlLlxuICAgKiBAcGFyYW0gY2FsbGJhY2sgVGhlIGNhbGxiYWNrIHdpdGggdGhlIHJlc3VsdCBvZiB0aGUgb3BlcmF0aW9uLlxuICAgKi9cbiAgcHVibGljIGRlbGV0ZUl0ZW1zKFxuICAgIGl0ZW1zOiBJdGVtUGF5bG9hZFtdLFxuICAgIGNhbGxiYWNrOiAoZGF0YTogSXRlbU1lc3NhZ2VQYXlsb2FkKSA9PiB2b2lkLFxuICApOiB2b2lkIHtcbiAgICBjb25zdCBwYXJhbXMgPSB7XG4gICAgICBpdGVtczogaXRlbXMubWFwKChpdGVtKSA9PiB7XG4gICAgICAgIHJldHVybiB0aGlzLmpzb25PYmplY3RGb3JJdGVtKGl0ZW0pXG4gICAgICB9KSxcbiAgICB9XG4gICAgdGhpcy5wb3N0TWVzc2FnZShDb21wb25lbnRBY3Rpb24uRGVsZXRlSXRlbXMsIHBhcmFtcywgKGRhdGEpID0+IHtcbiAgICAgIGNhbGxiYWNrICYmIGNhbGxiYWNrKGRhdGEpXG4gICAgfSlcbiAgfVxuXG4gIC8qKlxuICAgKiBQZXJmb3JtcyBhIGN1c3RvbSBhY3Rpb24gdG8gdGhlIGNvbXBvbmVudCBtYW5hZ2VyLlxuICAgKiBAcGFyYW0gYWN0aW9uXG4gICAqIEBwYXJhbSBkYXRhXG4gICAqIEBwYXJhbSBjYWxsYmFjayBUaGUgY2FsbGJhY2sgd2l0aCB0aGUgcmVzdWx0IG9mIHRoZSBvcGVyYXRpb24uXG4gICAqL1xuICBwdWJsaWMgc2VuZEN1c3RvbUV2ZW50KFxuICAgIGFjdGlvbjogQ29tcG9uZW50QWN0aW9uLFxuICAgIGRhdGE6IGFueSxcbiAgICBjYWxsYmFjaz86IChkYXRhOiBhbnkpID0+IHZvaWQsXG4gICk6IHZvaWQge1xuICAgIHRoaXMucG9zdE1lc3NhZ2UoYWN0aW9uLCBkYXRhLCAoZGF0YTogYW55KSA9PiB7XG4gICAgICBjYWxsYmFjayAmJiBjYWxsYmFjayhkYXRhKVxuICAgIH0pXG4gIH1cblxuICAvKipcbiAgICogU2F2ZXMgYW4gZXhpc3RpbmcgSXRlbSBpbiB0aGUgaXRlbSBzdG9yZS5cbiAgICogQHBhcmFtIGl0ZW0gQW4gZXhpc3RpbmcgSXRlbSB0byBiZSBzYXZlZC5cbiAgICogQHBhcmFtIGNhbGxiYWNrXG4gICAqIEBwYXJhbSBza2lwRGVib3VuY2VyXG4gICAqL1xuICBwdWJsaWMgc2F2ZUl0ZW0oXG4gICAgaXRlbTogSXRlbVBheWxvYWQsXG4gICAgY2FsbGJhY2s/OiAoKSA9PiB2b2lkLFxuICAgIHNraXBEZWJvdW5jZXIgPSBmYWxzZSxcbiAgKTogdm9pZCB7XG4gICAgdGhpcy5zYXZlSXRlbXMoW2l0ZW1dLCBjYWxsYmFjaywgc2tpcERlYm91bmNlcilcbiAgfVxuXG4gIC8qKlxuICAgKiBSdW5zIGEgY2FsbGJhY2sgYmVmb3JlIHNhdmluZyBhbiBJdGVtLlxuICAgKiBAcGFyYW0gaXRlbSBBbiBleGlzdGluZyBJdGVtIHRvIGJlIHNhdmVkLlxuICAgKiBAcGFyYW0gcHJlc2F2ZSBBbGxvd3MgY2xpZW50cyB0byBwZXJmb3JtIGFueSBhY3Rpb25zIGxhc3Qgc2Vjb25kIGJlZm9yZSB0aGUgc2F2ZSBhY3R1YWxseSBvY2N1cnMgKGxpa2Ugc2V0dGluZyBwcmV2aWV3cykuXG4gICAqIFNhdmVzIGRlYm91bmNlIGJ5IGRlZmF1bHQsIHNvIGlmIGEgY2xpZW50IG5lZWRzIHRvIGNvbXB1dGUgYSBwcm9wZXJ0eSBvbiBhbiBpdGVtIGJlZm9yZSBzYXZpbmcsIGl0J3MgYmVzdCB0b1xuICAgKiBob29rIGludG8gdGhlIGRlYm91bmNlIGN5Y2xlIHNvIHRoYXQgY2xpZW50cyBkb24ndCBoYXZlIHRvIGltcGxlbWVudCB0aGVpciBvd24gZGVib3VuY2luZy5cbiAgICogQHBhcmFtIGNhbGxiYWNrXG4gICAqL1xuICBwdWJsaWMgc2F2ZUl0ZW1XaXRoUHJlc2F2ZShcbiAgICBpdGVtOiBJdGVtUGF5bG9hZCxcbiAgICBwcmVzYXZlOiBhbnksXG4gICAgY2FsbGJhY2s/OiAoKSA9PiB2b2lkLFxuICApOiB2b2lkIHtcbiAgICB0aGlzLnNhdmVJdGVtc1dpdGhQcmVzYXZlKFtpdGVtXSwgcHJlc2F2ZSwgY2FsbGJhY2spXG4gIH1cblxuICAvKipcbiAgICogUnVucyBhIGNhbGxiYWNrIGJlZm9yZSBzYXZpbmcgYSBjb2xsZWN0aW9uIG9mIEl0ZW1zLlxuICAgKiBAcGFyYW0gaXRlbXMgQSBjb2xsZWN0aW9uIG9mIGV4aXN0aW5nIEl0ZW1zIHRvIGJlIHNhdmVkLlxuICAgKiBAcGFyYW0gcHJlc2F2ZSBBbGxvd3MgY2xpZW50cyB0byBwZXJmb3JtIGFueSBhY3Rpb25zIGxhc3Qgc2Vjb25kIGJlZm9yZSB0aGUgc2F2ZSBhY3R1YWxseSBvY2N1cnMgKGxpa2Ugc2V0dGluZyBwcmV2aWV3cykuXG4gICAqIFNhdmVzIGRlYm91bmNlIGJ5IGRlZmF1bHQsIHNvIGlmIGEgY2xpZW50IG5lZWRzIHRvIGNvbXB1dGUgYSBwcm9wZXJ0eSBvbiBhbiBpdGVtIGJlZm9yZSBzYXZpbmcsIGl0J3MgYmVzdCB0b1xuICAgKiBob29rIGludG8gdGhlIGRlYm91bmNlIGN5Y2xlIHNvIHRoYXQgY2xpZW50cyBkb24ndCBoYXZlIHRvIGltcGxlbWVudCB0aGVpciBvd24gZGVib3VuY2luZy5cbiAgICogQHBhcmFtIGNhbGxiYWNrXG4gICAqL1xuICBwdWJsaWMgc2F2ZUl0ZW1zV2l0aFByZXNhdmUoXG4gICAgaXRlbXM6IEl0ZW1QYXlsb2FkW10sXG4gICAgcHJlc2F2ZTogYW55LFxuICAgIGNhbGxiYWNrPzogKCkgPT4gdm9pZCxcbiAgKTogdm9pZCB7XG4gICAgdGhpcy5zYXZlSXRlbXMoaXRlbXMsIGNhbGxiYWNrLCBmYWxzZSwgcHJlc2F2ZSlcbiAgfVxuXG4gIHByaXZhdGUgcGVyZm9ybVNhdmluZ09mSXRlbXMoe1xuICAgIGl0ZW1zLFxuICAgIHByZXNhdmUsXG4gICAgY2FsbGJhY2ssXG4gIH06IHtcbiAgICBpdGVtczogSXRlbVBheWxvYWRbXVxuICAgIHByZXNhdmU6ICgpID0+IHZvaWRcbiAgICBjYWxsYmFjaz86ICgpID0+IHZvaWRcbiAgfSkge1xuICAgIGNvbnN0IENvbmNlcm5JbnRlcnZhbE1TID0gNTAwMFxuICAgIGNvbnN0IGNvbmNlcm5UaW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICB0aGlzLmNvbmNlcm5UaW1lb3V0cy5mb3JFYWNoKCh0aW1lb3V0KSA9PiBjbGVhclRpbWVvdXQodGltZW91dCkpXG4gICAgICBhbGVydChcbiAgICAgICAgJ1RoaXMgZWRpdG9yIGlzIHVuYWJsZSB0byBjb21tdW5pY2F0ZSB3aXRoIFN0YW5kYXJkIE5vdGVzLiAnICtcbiAgICAgICAgICAnWW91ciBjaGFuZ2VzIG1heSBub3QgYmUgc2F2ZWQuIFBsZWFzZSBiYWNrdXAgeW91ciBjaGFuZ2VzLCB0aGVuIHJlc3RhcnQgdGhlICcgK1xuICAgICAgICAgICdhcHBsaWNhdGlvbiBhbmQgdHJ5IGFnYWluLicsXG4gICAgICApXG4gICAgfSwgQ29uY2VybkludGVydmFsTVMpXG5cbiAgICB0aGlzLmNvbmNlcm5UaW1lb3V0cy5wdXNoKGNvbmNlcm5UaW1lb3V0KVxuXG4gICAgLyoqXG4gICAgICogUHJlc2F2ZSBibG9jayBhbGxvd3MgY2xpZW50IHRvIGdhaW4gdGhlIGJlbmVmaXQgb2YgcGVyZm9ybWluZyBzb21ldGhpbmcgaW4gdGhlIGRlYm91bmNlIGN5Y2xlLlxuICAgICAqL1xuICAgIHByZXNhdmUgJiYgcHJlc2F2ZSgpXG5cbiAgICBjb25zdCBtYXBwZWRJdGVtcyA9IFtdXG4gICAgZm9yIChjb25zdCBpdGVtIG9mIGl0ZW1zKSB7XG4gICAgICBtYXBwZWRJdGVtcy5wdXNoKHRoaXMuanNvbk9iamVjdEZvckl0ZW0oaXRlbSkpXG4gICAgfVxuXG4gICAgY29uc3Qgd3JhcHBlZENhbGxiYWNrID0gKCkgPT4ge1xuICAgICAgdGhpcy5jb25jZXJuVGltZW91dHMuZm9yRWFjaCgodGltZW91dCkgPT4gY2xlYXJUaW1lb3V0KHRpbWVvdXQpKVxuICAgICAgY2FsbGJhY2s/LigpXG4gICAgfVxuXG4gICAgdGhpcy5wb3N0TWVzc2FnZShcbiAgICAgIENvbXBvbmVudEFjdGlvbi5TYXZlSXRlbXMsXG4gICAgICB7IGl0ZW1zOiBtYXBwZWRJdGVtcyB9LFxuICAgICAgd3JhcHBlZENhbGxiYWNrLFxuICAgIClcbiAgfVxuXG4gIC8qKlxuICAgKiBTYXZlcyBhIGNvbGxlY3Rpb24gb2YgZXhpc3RpbmcgSXRlbXMuXG4gICAqIEBwYXJhbSBpdGVtcyBUaGUgaXRlbXMgdG8gYmUgc2F2ZWQuXG4gICAqIEBwYXJhbSBjYWxsYmFja1xuICAgKiBAcGFyYW0gc2tpcERlYm91bmNlciBBbGxvd3Mgc2F2ZXMgdG8gZ28gdGhyb3VnaCByaWdodCBhd2F5IHJhdGhlciB0aGFuIHdhaXRpbmcgZm9yIHRpbWVvdXQuXG4gICAqIFRoaXMgc2hvdWxkIGJlIHVzZWQgd2hlbiBzYXZpbmcgaXRlbXMgdmlhIG90aGVyIG1lYW5zIGJlc2lkZXMga2V5c3Ryb2tlcy5cbiAgICogQHBhcmFtIHByZXNhdmVcbiAgICovXG4gIHB1YmxpYyBzYXZlSXRlbXMoXG4gICAgaXRlbXM6IEl0ZW1QYXlsb2FkW10sXG4gICAgY2FsbGJhY2s/OiAoKSA9PiB2b2lkLFxuICAgIHNraXBEZWJvdW5jZXIgPSBmYWxzZSxcbiAgICBwcmVzYXZlPzogYW55LFxuICApOiB2b2lkIHtcbiAgICAvKipcbiAgICAgKiBXZSBuZWVkIHRvIG1ha2Ugc3VyZSB0aGF0IHdoZW4gd2UgY2xlYXIgYSBwZW5kaW5nIHNhdmUgdGltZW91dCxcbiAgICAgKiB3ZSBjYXJyeSBvdmVyIHRob3NlIHBlbmRpbmcgaXRlbXMgaW50byB0aGUgbmV3IHNhdmUuXG4gICAgICovXG4gICAgaWYgKCF0aGlzLnBlbmRpbmdTYXZlSXRlbXMpIHtcbiAgICAgIHRoaXMucGVuZGluZ1NhdmVJdGVtcyA9IFtdXG4gICAgfVxuXG4gICAgaWYgKHRoaXMuY29hbGxlc2VkU2F2aW5nICYmICFza2lwRGVib3VuY2VyKSB7XG4gICAgICBpZiAodGhpcy5wZW5kaW5nU2F2ZVRpbWVvdXQpIHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMucGVuZGluZ1NhdmVUaW1lb3V0KVxuICAgICAgfVxuXG4gICAgICBjb25zdCBpbmNvbWluZ0lkcyA9IGl0ZW1zLm1hcCgoaXRlbSkgPT4gaXRlbS51dWlkKVxuICAgICAgLyoqXG4gICAgICAgKiBSZXBsYWNlIGFueSBleGlzdGluZyBzYXZlIGl0ZW1zIHdpdGggaW5jb21pbmcgdmFsdWVzLlxuICAgICAgICogT25seSBrZWVwIGl0ZW1zIGhlcmUgd2hvIGFyZSBub3QgaW4gaW5jb21pbmdJZHMuXG4gICAgICAgKi9cbiAgICAgIGNvbnN0IHByZWV4aXN0aW5nSXRlbXMgPSB0aGlzLnBlbmRpbmdTYXZlSXRlbXMuZmlsdGVyKChpdGVtKSA9PiB7XG4gICAgICAgIHJldHVybiAhaW5jb21pbmdJZHMuaW5jbHVkZXMoaXRlbS51dWlkKVxuICAgICAgfSlcblxuICAgICAgLy8gQWRkIG5ldyBpdGVtcywgbm93IHRoYXQgd2UndmUgbWFkZSBzdXJlIGl0J3MgY2xlYXJlZCBvZiBpbmNvbWluZyBpdGVtcy5cbiAgICAgIHRoaXMucGVuZGluZ1NhdmVJdGVtcyA9IHByZWV4aXN0aW5nSXRlbXMuY29uY2F0KGl0ZW1zKVxuXG4gICAgICAvLyBXZSdsbCBwb3RlbnRpYWxseSBuZWVkIHRvIGNvbW1pdCBlYXJseSBpZiBzdHJlYW0tY29udGV4dC1pdGVtIG1lc3NhZ2UgY29tZXMgaW4uXG4gICAgICB0aGlzLnBlbmRpbmdTYXZlUGFyYW1zID0ge1xuICAgICAgICBpdGVtczogdGhpcy5wZW5kaW5nU2F2ZUl0ZW1zLFxuICAgICAgICBwcmVzYXZlLFxuICAgICAgICBjYWxsYmFjayxcbiAgICAgIH1cblxuICAgICAgdGhpcy5wZW5kaW5nU2F2ZVRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgdGhpcy5wZXJmb3JtU2F2aW5nT2ZJdGVtcyh0aGlzLnBlbmRpbmdTYXZlUGFyYW1zKVxuICAgICAgICB0aGlzLnBlbmRpbmdTYXZlSXRlbXMgPSBbXVxuICAgICAgICB0aGlzLnBlbmRpbmdTYXZlVGltZW91dCA9IHVuZGVmaW5lZFxuICAgICAgICB0aGlzLnBlbmRpbmdTYXZlUGFyYW1zID0gbnVsbFxuICAgICAgfSwgdGhpcy5jb2FsbGVzZWRTYXZpbmdEZWxheSlcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5wZXJmb3JtU2F2aW5nT2ZJdGVtcyh7IGl0ZW1zLCBwcmVzYXZlLCBjYWxsYmFjayB9KVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBTZXRzIGEgbmV3IGNvbnRhaW5lciBzaXplIGZvciB0aGUgY3VycmVudCBjb21wb25lbnQuXG4gICAqIEBwYXJhbSB3aWR0aCBUaGUgbmV3IHdpZHRoLlxuICAgKiBAcGFyYW0gaGVpZ2h0IFRoZSBuZXcgaGVpZ2h0LlxuICAgKi9cbiAgcHVibGljIHNldFNpemUod2lkdGg6IHN0cmluZyB8IG51bWJlciwgaGVpZ2h0OiBzdHJpbmcgfCBudW1iZXIpOiB2b2lkIHtcbiAgICB0aGlzLnBvc3RNZXNzYWdlKENvbXBvbmVudEFjdGlvbi5TZXRTaXplLCB7XG4gICAgICB0eXBlOiAnY29udGFpbmVyJyxcbiAgICAgIHdpZHRoLFxuICAgICAgaGVpZ2h0LFxuICAgIH0pXG4gIH1cblxuICAvKipcbiAgICogU2VuZHMgdGhlIEtleURvd24ga2V5Ym9hcmQgZXZlbnQgdG8gdGhlIFN0YW5kYXJkIE5vdGVzIHBhcmVudCBhcHBsaWNhdGlvbi5cbiAgICogQHBhcmFtIGtleWJvYXJkTW9kaWZpZXIgVGhlIGtleWJvYXJkIG1vZGlmaWVyIHRoYXQgd2FzIHByZXNzZWQuXG4gICAqL1xuICBwcml2YXRlIGtleURvd25FdmVudChrZXlib2FyZE1vZGlmaWVyOiBLZXlib2FyZE1vZGlmaWVyKTogdm9pZCB7XG4gICAgdGhpcy5wb3N0TWVzc2FnZShDb21wb25lbnRBY3Rpb24uS2V5RG93biwgeyBrZXlib2FyZE1vZGlmaWVyIH0pXG4gIH1cblxuICAvKipcbiAgICogU2VuZHMgdGhlIEtleVVwIGtleWJvYXJkIGV2ZW50IHRvIHRoZSBTdGFuZGFyZCBOb3RlcyBwYXJlbnQgYXBwbGljYXRpb24uXG4gICAqIEBwYXJhbSBrZXlib2FyZE1vZGlmaWVyIFRoZSBrZXlib2FyZCBtb2RpZmllciB0aGF0IHdhcyByZWxlYXNlZC5cbiAgICovXG4gIHByaXZhdGUga2V5VXBFdmVudChrZXlib2FyZE1vZGlmaWVyOiBLZXlib2FyZE1vZGlmaWVyKTogdm9pZCB7XG4gICAgdGhpcy5wb3N0TWVzc2FnZShDb21wb25lbnRBY3Rpb24uS2V5VXAsIHsga2V5Ym9hcmRNb2RpZmllciB9KVxuICB9XG5cbiAgLyoqXG4gICAqIFNlbmRzIHRoZSBDbGljayBtb3VzZSBldmVudCB0byB0aGUgU3RhbmRhcmQgTm90ZXMgcGFyZW50IGFwcGxpY2F0aW9uLlxuICAgKi9cbiAgcHJpdmF0ZSBtb3VzZUNsaWNrRXZlbnQoKTogdm9pZCB7XG4gICAgdGhpcy5wb3N0TWVzc2FnZShDb21wb25lbnRBY3Rpb24uQ2xpY2ssIHt9KVxuICB9XG5cbiAgcHJpdmF0ZSBqc29uT2JqZWN0Rm9ySXRlbShpdGVtOiBTTkl0ZW0gfCBJdGVtUGF5bG9hZCkge1xuICAgIGNvbnN0IGNvcHkgPSBPYmplY3QuYXNzaWduKHt9LCBpdGVtKSBhcyBhbnlcbiAgICBjb3B5LmNoaWxkcmVuID0gbnVsbFxuICAgIGNvcHkucGFyZW50ID0gbnVsbFxuICAgIHJldHVybiBjb3B5XG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgSXRlbSdzIGFwcERhdGEgdmFsdWUgZm9yIHRoZSBzcGVjaWZpZWQga2V5LlxuICAgKiBVc2VzIHRoZSBkZWZhdWx0IGRvbWFpbiAob3JnLnN0YW5kYXJkbm90ZXMuc24pLlxuICAgKiBUaGlzIGZ1bmN0aW9uIGlzIHVzZWQgd2l0aCBJdGVtcyByZXR1cm5lZCBmcm9tIHN0cmVhbUNvbnRleHRJdGVtKCkgYW5kIHN0cmVhbUl0ZW1zKClcbiAgICogQHBhcmFtIGl0ZW0gVGhlIEl0ZW0gdG8gZ2V0IHRoZSBhcHBEYXRhIHZhbHVlIGZyb20uXG4gICAqIEBwYXJhbSBrZXkgVGhlIGtleSB0byBnZXQgdGhlIHZhbHVlIGZyb20uXG4gICAqL1xuICBwdWJsaWMgZ2V0SXRlbUFwcERhdGFWYWx1ZShcbiAgICBpdGVtOiBJdGVtTWVzc2FnZVBheWxvYWQgfCB1bmRlZmluZWQsXG4gICAga2V5OiBBcHBEYXRhRmllbGQgfCBzdHJpbmcsXG4gICk6IGFueSB7XG4gICAgY29uc3QgZGVmYXVsdERvbWFpbiA9ICdvcmcuc3RhbmRhcmRub3Rlcy5zbidcbiAgICByZXR1cm4gaXRlbT8uY29udGVudD8uYXBwRGF0YT8uW2RlZmF1bHREb21haW5dW2tleV1cbiAgfVxufVxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBQUE7QUFhQTtBQU1BO0FBRUE7QUFFQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBQ0E7QUF5RUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUtBO0FBb0JBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUFoQkE7QUFBQTtBQUFBO0FBQ0E7QUFlQTtBQUNBO0FBREE7QUFDQTtBQURBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUFDQTtBQURBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUFDQTtBQURBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUFDQTtBQURBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFLQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUExQ0E7QUE0Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBQ0E7QUFHQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUNBO0FBR0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBRkE7QUFJQTtBQUNBO0FBREE7QUFHQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFDQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBUUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFJQTtBQUVBO0FBQUE7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFJQTtBQUVBO0FBQUE7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFDQTtBQUNBO0FBREE7QUFHQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFDQTtBQUVBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFJQTtBQUNBO0FBRUE7QUFBQTtBQUVBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBQ0E7QUFDQTtBQURBO0FBR0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUlBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFJQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBS0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQVFBO0FBUEE7QUFDQTtBQUNBO0FBSEE7QUFTQTtBQUNBO0FBQ0E7QUFDQTtBQUtBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUdBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUtBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQUtBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFEQTtBQUdBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQWwzQkEiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./lib/componentRelay.ts\n");

/***/ }),

/***/ "./lib/logger.ts":
/*!***********************!*\
  !*** ./lib/logger.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ Logger)\n/* harmony export */ });\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nconst noop = () => undefined;\n\nclass Logger {\n  static get isSupported() {\n    return window.console || console ? true : false;\n  }\n\n  static get info() {\n    if (!Logger.isSupported || !this.enabled) {\n      return noop;\n    }\n\n    return console.log.bind(console);\n  }\n\n  static get error() {\n    if (!Logger.isSupported) {\n      return noop;\n    }\n\n    return console.error.bind(console);\n  }\n\n}\n\n_defineProperty(Logger, \"enabled\", false);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9saWIvbG9nZ2VyLnRzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vQ29tcG9uZW50UmVsYXkvLi9saWIvbG9nZ2VyLnRzPzQ4NTMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qgbm9vcCA9ICgpID0+IHVuZGVmaW5lZFxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBMb2dnZXIge1xuICBzdGF0aWMgZW5hYmxlZCA9IGZhbHNlO1xuXG4gIHByaXZhdGUgc3RhdGljIGdldCBpc1N1cHBvcnRlZCgpIHtcbiAgICByZXR1cm4gKHdpbmRvdy5jb25zb2xlIHx8IGNvbnNvbGUpID8gdHJ1ZSA6IGZhbHNlXG4gIH1cblxuICBzdGF0aWMgZ2V0IGluZm8gKCkgOiBhbnkge1xuICAgIGlmICghTG9nZ2VyLmlzU3VwcG9ydGVkIHx8ICF0aGlzLmVuYWJsZWQpIHtcbiAgICAgIHJldHVybiBub29wXG4gICAgfVxuICAgIHJldHVybiBjb25zb2xlLmxvZy5iaW5kKGNvbnNvbGUpXG4gIH1cblxuICBzdGF0aWMgZ2V0IGVycm9yICgpIDogYW55IHtcbiAgICBpZiAoIUxvZ2dlci5pc1N1cHBvcnRlZCkge1xuICAgICAgcmV0dXJuIG5vb3BcbiAgICB9XG4gICAgcmV0dXJuIGNvbnNvbGUuZXJyb3IuYmluZChjb25zb2xlKVxuICB9XG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFwQkE7QUFDQTtBQURBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./lib/logger.ts\n");

/***/ }),

/***/ "./lib/snjsTypes.ts":
/*!**************************!*\
  !*** ./lib/snjsTypes.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"ComponentAction\": () => (/* binding */ ComponentAction),\n/* harmony export */   \"Environment\": () => (/* binding */ Environment),\n/* harmony export */   \"ContentType\": () => (/* binding */ ContentType),\n/* harmony export */   \"AppDataField\": () => (/* binding */ AppDataField)\n/* harmony export */ });\n/**\n * Declaring types needed from snjs.\n * This file will be deleted after snjs becomes a monorepo and provides such types.\n */\n\n/**\n * The available actions that a component can perform.\n */\nlet ComponentAction;\n\n(function (ComponentAction) {\n  ComponentAction[\"SetSize\"] = \"set-size\";\n  ComponentAction[\"StreamItems\"] = \"stream-items\";\n  ComponentAction[\"StreamContextItem\"] = \"stream-context-item\";\n  ComponentAction[\"SaveItems\"] = \"save-items\";\n  ComponentAction[\"SelectItem\"] = \"select-item\";\n  ComponentAction[\"AssociateItem\"] = \"associate-item\";\n  ComponentAction[\"DeassociateItem\"] = \"deassociate-item\";\n  ComponentAction[\"ClearSelection\"] = \"clear-selection\";\n  ComponentAction[\"CreateItem\"] = \"create-item\";\n  ComponentAction[\"CreateItems\"] = \"create-items\";\n  ComponentAction[\"DeleteItems\"] = \"delete-items\";\n  ComponentAction[\"SetComponentData\"] = \"set-component-data\";\n  ComponentAction[\"InstallLocalComponent\"] = \"install-local-component\";\n  ComponentAction[\"ToggleActivateComponent\"] = \"toggle-activate-component\";\n  ComponentAction[\"RequestPermissions\"] = \"request-permissions\";\n  ComponentAction[\"PresentConflictResolution\"] = \"present-conflict-resolution\";\n  ComponentAction[\"DuplicateItem\"] = \"duplicate-item\";\n  ComponentAction[\"ComponentRegistered\"] = \"component-registered\";\n  ComponentAction[\"ActivateThemes\"] = \"themes\";\n  ComponentAction[\"Reply\"] = \"reply\";\n  ComponentAction[\"SaveSuccess\"] = \"save-success\";\n  ComponentAction[\"SaveError\"] = \"save-error\";\n  ComponentAction[\"ThemesActivated\"] = \"themes-activated\";\n  ComponentAction[\"KeyDown\"] = \"key-down\";\n  ComponentAction[\"KeyUp\"] = \"key-up\";\n  ComponentAction[\"Click\"] = \"click\";\n})(ComponentAction || (ComponentAction = {}));\n\nlet Environment;\n\n(function (Environment) {\n  Environment[Environment[\"Web\"] = 1] = \"Web\";\n  Environment[Environment[\"Desktop\"] = 2] = \"Desktop\";\n  Environment[Environment[\"Mobile\"] = 3] = \"Mobile\";\n})(Environment || (Environment = {}));\n\nlet ContentType;\n\n(function (ContentType) {\n  ContentType[\"Any\"] = \"*\";\n  ContentType[\"Item\"] = \"SF|Item\";\n  ContentType[\"RootKey\"] = \"SN|RootKey|NoSync\";\n  ContentType[\"ItemsKey\"] = \"SN|ItemsKey\";\n  ContentType[\"EncryptedStorage\"] = \"SN|EncryptedStorage\";\n  ContentType[\"Note\"] = \"Note\";\n  ContentType[\"Tag\"] = \"Tag\";\n  ContentType[\"SmartTag\"] = \"SN|SmartTag\";\n  ContentType[\"Component\"] = \"SN|Component\";\n  ContentType[\"Editor\"] = \"SN|Editor\";\n  ContentType[\"ActionsExtension\"] = \"Extension\";\n  ContentType[\"UserPrefs\"] = \"SN|UserPreferences\";\n  ContentType[\"HistorySession\"] = \"SN|HistorySession\";\n  ContentType[\"Theme\"] = \"SN|Theme\";\n  ContentType[\"Mfa\"] = \"SF|MFA\";\n  ContentType[\"ServerExtension\"] = \"SF|Extension\";\n  ContentType[\"FilesafeCredentials\"] = \"SN|FileSafe|Credentials\";\n  ContentType[\"FilesafeFileMetadata\"] = \"SN|FileSafe|FileMetadata\";\n  ContentType[\"FilesafeIntegration\"] = \"SN|FileSafe|Integration\";\n  ContentType[\"ExtensionRepo\"] = \"SN|ExtensionRepo\";\n})(ContentType || (ContentType = {}));\n\nlet AppDataField;\n\n(function (AppDataField) {\n  AppDataField[\"Pinned\"] = \"pinned\";\n  AppDataField[\"Archived\"] = \"archived\";\n  AppDataField[\"Locked\"] = \"locked\";\n  AppDataField[\"UserModifiedDate\"] = \"client_updated_at\";\n  AppDataField[\"DefaultEditor\"] = \"defaultEditor\";\n  AppDataField[\"MobileRules\"] = \"mobileRules\";\n  AppDataField[\"NotAvailableOnMobile\"] = \"notAvailableOnMobile\";\n  AppDataField[\"MobileActive\"] = \"mobileActive\";\n  AppDataField[\"LastSize\"] = \"lastSize\";\n  AppDataField[\"PrefersPlainEditor\"] = \"prefersPlainEditor\";\n  AppDataField[\"ComponentInstallError\"] = \"installError\";\n})(AppDataField || (AppDataField = {}));//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9saWIvc25qc1R5cGVzLnRzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vQ29tcG9uZW50UmVsYXkvLi9saWIvc25qc1R5cGVzLnRzP2Y4N2YiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBEZWNsYXJpbmcgdHlwZXMgbmVlZGVkIGZyb20gc25qcy5cbiAqIFRoaXMgZmlsZSB3aWxsIGJlIGRlbGV0ZWQgYWZ0ZXIgc25qcyBiZWNvbWVzIGEgbW9ub3JlcG8gYW5kIHByb3ZpZGVzIHN1Y2ggdHlwZXMuXG4gKi9cblxuLyoqXG4gKiBUaGUgYXZhaWxhYmxlIGFjdGlvbnMgdGhhdCBhIGNvbXBvbmVudCBjYW4gcGVyZm9ybS5cbiAqL1xuZXhwb3J0IGVudW0gQ29tcG9uZW50QWN0aW9uIHtcbiAgU2V0U2l6ZSA9ICdzZXQtc2l6ZScsXG4gIFN0cmVhbUl0ZW1zID0gJ3N0cmVhbS1pdGVtcycsXG4gIFN0cmVhbUNvbnRleHRJdGVtID0gJ3N0cmVhbS1jb250ZXh0LWl0ZW0nLFxuICBTYXZlSXRlbXMgPSAnc2F2ZS1pdGVtcycsXG4gIFNlbGVjdEl0ZW0gPSAnc2VsZWN0LWl0ZW0nLFxuICBBc3NvY2lhdGVJdGVtID0gJ2Fzc29jaWF0ZS1pdGVtJyxcbiAgRGVhc3NvY2lhdGVJdGVtID0gJ2RlYXNzb2NpYXRlLWl0ZW0nLFxuICBDbGVhclNlbGVjdGlvbiA9ICdjbGVhci1zZWxlY3Rpb24nLFxuICBDcmVhdGVJdGVtID0gJ2NyZWF0ZS1pdGVtJyxcbiAgQ3JlYXRlSXRlbXMgPSAnY3JlYXRlLWl0ZW1zJyxcbiAgRGVsZXRlSXRlbXMgPSAnZGVsZXRlLWl0ZW1zJyxcbiAgU2V0Q29tcG9uZW50RGF0YSA9ICdzZXQtY29tcG9uZW50LWRhdGEnLFxuICBJbnN0YWxsTG9jYWxDb21wb25lbnQgPSAnaW5zdGFsbC1sb2NhbC1jb21wb25lbnQnLFxuICBUb2dnbGVBY3RpdmF0ZUNvbXBvbmVudCA9ICd0b2dnbGUtYWN0aXZhdGUtY29tcG9uZW50JyxcbiAgUmVxdWVzdFBlcm1pc3Npb25zID0gJ3JlcXVlc3QtcGVybWlzc2lvbnMnLFxuICBQcmVzZW50Q29uZmxpY3RSZXNvbHV0aW9uID0gJ3ByZXNlbnQtY29uZmxpY3QtcmVzb2x1dGlvbicsXG4gIER1cGxpY2F0ZUl0ZW0gPSAnZHVwbGljYXRlLWl0ZW0nLFxuICBDb21wb25lbnRSZWdpc3RlcmVkID0gJ2NvbXBvbmVudC1yZWdpc3RlcmVkJyxcbiAgQWN0aXZhdGVUaGVtZXMgPSAndGhlbWVzJyxcbiAgUmVwbHkgPSAncmVwbHknLFxuICBTYXZlU3VjY2VzcyA9ICdzYXZlLXN1Y2Nlc3MnLFxuICBTYXZlRXJyb3IgPSAnc2F2ZS1lcnJvcicsXG4gIFRoZW1lc0FjdGl2YXRlZCA9ICd0aGVtZXMtYWN0aXZhdGVkJyxcbiAgS2V5RG93biA9ICdrZXktZG93bicsXG4gIEtleVVwID0gJ2tleS11cCcsXG4gIENsaWNrID0gJ2NsaWNrJ1xufVxuXG5leHBvcnQgZW51bSBFbnZpcm9ubWVudCB7XG4gIFdlYiA9IDEsXG4gIERlc2t0b3AgPSAyLFxuICBNb2JpbGUgPSAzXG59XG5cbmV4cG9ydCBlbnVtIENvbnRlbnRUeXBlIHtcbiAgQW55ID0gJyonLFxuICBJdGVtID0gJ1NGfEl0ZW0nLFxuICBSb290S2V5ID0gJ1NOfFJvb3RLZXl8Tm9TeW5jJyxcbiAgSXRlbXNLZXkgPSAnU058SXRlbXNLZXknLFxuICBFbmNyeXB0ZWRTdG9yYWdlID0gJ1NOfEVuY3J5cHRlZFN0b3JhZ2UnLFxuICBOb3RlID0gJ05vdGUnLFxuICBUYWcgPSAnVGFnJyxcbiAgU21hcnRUYWcgPSAnU058U21hcnRUYWcnLFxuICBDb21wb25lbnQgPSAnU058Q29tcG9uZW50JyxcbiAgRWRpdG9yID0gJ1NOfEVkaXRvcicsXG4gIEFjdGlvbnNFeHRlbnNpb24gPSAnRXh0ZW5zaW9uJyxcbiAgVXNlclByZWZzID0gJ1NOfFVzZXJQcmVmZXJlbmNlcycsXG4gIEhpc3RvcnlTZXNzaW9uID0gJ1NOfEhpc3RvcnlTZXNzaW9uJyxcbiAgVGhlbWUgPSAnU058VGhlbWUnLFxuICBNZmEgPSAnU0Z8TUZBJyxcbiAgU2VydmVyRXh0ZW5zaW9uID0gJ1NGfEV4dGVuc2lvbicsXG4gIEZpbGVzYWZlQ3JlZGVudGlhbHMgPSAnU058RmlsZVNhZmV8Q3JlZGVudGlhbHMnLFxuICBGaWxlc2FmZUZpbGVNZXRhZGF0YSA9ICdTTnxGaWxlU2FmZXxGaWxlTWV0YWRhdGEnLFxuICBGaWxlc2FmZUludGVncmF0aW9uID0gJ1NOfEZpbGVTYWZlfEludGVncmF0aW9uJyxcbiAgRXh0ZW5zaW9uUmVwbyA9ICdTTnxFeHRlbnNpb25SZXBvJyxcbn1cblxuZXhwb3J0IGVudW0gQXBwRGF0YUZpZWxkIHtcbiAgUGlubmVkID0gJ3Bpbm5lZCcsXG4gIEFyY2hpdmVkID0gJ2FyY2hpdmVkJyxcbiAgTG9ja2VkID0gJ2xvY2tlZCcsXG4gIFVzZXJNb2RpZmllZERhdGUgPSAnY2xpZW50X3VwZGF0ZWRfYXQnLFxuICBEZWZhdWx0RWRpdG9yID0gJ2RlZmF1bHRFZGl0b3InLFxuICBNb2JpbGVSdWxlcyA9ICdtb2JpbGVSdWxlcycsXG4gIE5vdEF2YWlsYWJsZU9uTW9iaWxlID0gJ25vdEF2YWlsYWJsZU9uTW9iaWxlJyxcbiAgTW9iaWxlQWN0aXZlID0gJ21vYmlsZUFjdGl2ZScsXG4gIExhc3RTaXplID0gJ2xhc3RTaXplJyxcbiAgUHJlZmVyc1BsYWluRWRpdG9yID0gJ3ByZWZlcnNQbGFpbkVkaXRvcicsXG4gIENvbXBvbmVudEluc3RhbGxFcnJvciA9ICdpbnN0YWxsRXJyb3InXG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUE0QkE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUtBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBc0JBO0FBQ0E7QUFEQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./lib/snjsTypes.ts\n");

/***/ }),

/***/ "./lib/utils.ts":
/*!**********************!*\
  !*** ./lib/utils.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"generateUuid\": () => (/* binding */ generateUuid),\n/* harmony export */   \"isValidJsonString\": () => (/* binding */ isValidJsonString),\n/* harmony export */   \"environmentToString\": () => (/* binding */ environmentToString),\n/* harmony export */   \"isNotUndefinedOrNull\": () => (/* binding */ isNotUndefinedOrNull)\n/* harmony export */ });\n/* harmony import */ var _snjsTypes__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./snjsTypes */ \"./lib/snjsTypes.ts\");\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! uuid */ \"./node_modules/uuid/dist/esm-browser/v4.js\");\n\n\nconst generateUuid = () => {\n  return (0,uuid__WEBPACK_IMPORTED_MODULE_1__.default)();\n};\nconst isValidJsonString = str => {\n  if (typeof str !== 'string') {\n    return false;\n  }\n\n  try {\n    const result = JSON.parse(str);\n    const type = Object.prototype.toString.call(result);\n    return type === '[object Object]' || type === '[object Array]';\n  } catch (e) {\n    return false;\n  }\n};\nconst environmentToString = environment => {\n  var _map$environment;\n\n  const map = {\n    [_snjsTypes__WEBPACK_IMPORTED_MODULE_0__.Environment.Web]: 'web',\n    [_snjsTypes__WEBPACK_IMPORTED_MODULE_0__.Environment.Desktop]: 'desktop',\n    [_snjsTypes__WEBPACK_IMPORTED_MODULE_0__.Environment.Mobile]: 'mobile'\n  };\n  return (_map$environment = map[environment]) !== null && _map$environment !== void 0 ? _map$environment : map[_snjsTypes__WEBPACK_IMPORTED_MODULE_0__.Environment.Web];\n};\nconst isNotUndefinedOrNull = value => {\n  return value !== null && value !== undefined;\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9saWIvdXRpbHMudHMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9Db21wb25lbnRSZWxheS8uL2xpYi91dGlscy50cz9hMDgxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEVudmlyb25tZW50IH0gZnJvbSAnLi9zbmpzVHlwZXMnXG5pbXBvcnQgeyB2NCBhcyB1dWlkdjQgfSBmcm9tICd1dWlkJ1xuXG5kZWNsYXJlIGdsb2JhbCB7XG4gIGludGVyZmFjZSBXaW5kb3cgeyBtc0NyeXB0bzogdW5rbm93bjsgfVxufVxuXG5leHBvcnQgY29uc3QgZ2VuZXJhdGVVdWlkID0gKCkgOiBzdHJpbmcgPT4ge1xuICByZXR1cm4gdXVpZHY0KClcbn1cblxuZXhwb3J0IGNvbnN0IGlzVmFsaWRKc29uU3RyaW5nID0gKHN0cjogdW5rbm93bikgOiBib29sZWFuID0+IHtcbiAgaWYgKHR5cGVvZiBzdHIgIT09ICdzdHJpbmcnKSB7XG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cbiAgdHJ5IHtcbiAgICBjb25zdCByZXN1bHQgPSBKU09OLnBhcnNlKHN0cilcbiAgICBjb25zdCB0eXBlID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHJlc3VsdClcbiAgICByZXR1cm4gdHlwZSA9PT0gJ1tvYmplY3QgT2JqZWN0XScgfHwgdHlwZSA9PT0gJ1tvYmplY3QgQXJyYXldJ1xuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IGVudmlyb25tZW50VG9TdHJpbmcgPSAoZW52aXJvbm1lbnQ6IEVudmlyb25tZW50KSA6IHN0cmluZyA9PiB7XG4gIGNvbnN0IG1hcCA9IHtcbiAgICBbRW52aXJvbm1lbnQuV2ViXTogJ3dlYicsXG4gICAgW0Vudmlyb25tZW50LkRlc2t0b3BdOiAnZGVza3RvcCcsXG4gICAgW0Vudmlyb25tZW50Lk1vYmlsZV06ICdtb2JpbGUnLFxuICB9XG4gIHJldHVybiBtYXBbZW52aXJvbm1lbnRdID8/IG1hcFtFbnZpcm9ubWVudC5XZWJdXG59XG5cbmV4cG9ydCBjb25zdCBpc05vdFVuZGVmaW5lZE9yTnVsbCA9ICh2YWx1ZTogYW55KSA6IGJvb2xlYW4gPT4ge1xuICByZXR1cm4gdmFsdWUgIT09IG51bGwgJiYgdmFsdWUgIT09IHVuZGVmaW5lZFxufVxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQTtBQUNBO0FBTUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFDQTtBQUVBO0FBQ0E7QUFDQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./lib/utils.ts\n");

/***/ }),

/***/ "./node_modules/uuid/dist/esm-browser/regex.js":
/*!*****************************************************!*\
  !*** ./node_modules/uuid/dist/esm-browser/regex.js ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS1icm93c2VyL3JlZ2V4LmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vQ29tcG9uZW50UmVsYXkvLi9ub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS1icm93c2VyL3JlZ2V4LmpzPzQwZDYiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgL14oPzpbMC05YS1mXXs4fS1bMC05YS1mXXs0fS1bMS01XVswLTlhLWZdezN9LVs4OWFiXVswLTlhLWZdezN9LVswLTlhLWZdezEyfXwwMDAwMDAwMC0wMDAwLTAwMDAtMDAwMC0wMDAwMDAwMDAwMDApJC9pOyJdLCJtYXBwaW5ncyI6Ijs7OztBQUFBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/uuid/dist/esm-browser/regex.js\n");

/***/ }),

/***/ "./node_modules/uuid/dist/esm-browser/rng.js":
/*!***************************************************!*\
  !*** ./node_modules/uuid/dist/esm-browser/rng.js ***!
  \***************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ rng)\n/* harmony export */ });\n// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\nvar getRandomValues;\nvar rnds8 = new Uint8Array(16);\nfunction rng() {\n  // lazy load so that environments that need to polyfill have a chance to do so\n  if (!getRandomValues) {\n    // getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation. Also,\n    // find the complete implementation of crypto (msCrypto) on IE11.\n    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto) || typeof msCrypto !== 'undefined' && typeof msCrypto.getRandomValues === 'function' && msCrypto.getRandomValues.bind(msCrypto);\n\n    if (!getRandomValues) {\n      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n    }\n  }\n\n  return getRandomValues(rnds8);\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS1icm93c2VyL3JuZy5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovL0NvbXBvbmVudFJlbGF5Ly4vbm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci9ybmcuanM/ZDhmOCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBVbmlxdWUgSUQgY3JlYXRpb24gcmVxdWlyZXMgYSBoaWdoIHF1YWxpdHkgcmFuZG9tICMgZ2VuZXJhdG9yLiBJbiB0aGUgYnJvd3NlciB3ZSB0aGVyZWZvcmVcbi8vIHJlcXVpcmUgdGhlIGNyeXB0byBBUEkgYW5kIGRvIG5vdCBzdXBwb3J0IGJ1aWx0LWluIGZhbGxiYWNrIHRvIGxvd2VyIHF1YWxpdHkgcmFuZG9tIG51bWJlclxuLy8gZ2VuZXJhdG9ycyAobGlrZSBNYXRoLnJhbmRvbSgpKS5cbnZhciBnZXRSYW5kb21WYWx1ZXM7XG52YXIgcm5kczggPSBuZXcgVWludDhBcnJheSgxNik7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBybmcoKSB7XG4gIC8vIGxhenkgbG9hZCBzbyB0aGF0IGVudmlyb25tZW50cyB0aGF0IG5lZWQgdG8gcG9seWZpbGwgaGF2ZSBhIGNoYW5jZSB0byBkbyBzb1xuICBpZiAoIWdldFJhbmRvbVZhbHVlcykge1xuICAgIC8vIGdldFJhbmRvbVZhbHVlcyBuZWVkcyB0byBiZSBpbnZva2VkIGluIGEgY29udGV4dCB3aGVyZSBcInRoaXNcIiBpcyBhIENyeXB0byBpbXBsZW1lbnRhdGlvbi4gQWxzbyxcbiAgICAvLyBmaW5kIHRoZSBjb21wbGV0ZSBpbXBsZW1lbnRhdGlvbiBvZiBjcnlwdG8gKG1zQ3J5cHRvKSBvbiBJRTExLlxuICAgIGdldFJhbmRvbVZhbHVlcyA9IHR5cGVvZiBjcnlwdG8gIT09ICd1bmRlZmluZWQnICYmIGNyeXB0by5nZXRSYW5kb21WYWx1ZXMgJiYgY3J5cHRvLmdldFJhbmRvbVZhbHVlcy5iaW5kKGNyeXB0bykgfHwgdHlwZW9mIG1zQ3J5cHRvICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgbXNDcnlwdG8uZ2V0UmFuZG9tVmFsdWVzID09PSAnZnVuY3Rpb24nICYmIG1zQ3J5cHRvLmdldFJhbmRvbVZhbHVlcy5iaW5kKG1zQ3J5cHRvKTtcblxuICAgIGlmICghZ2V0UmFuZG9tVmFsdWVzKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ2NyeXB0by5nZXRSYW5kb21WYWx1ZXMoKSBub3Qgc3VwcG9ydGVkLiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL3V1aWRqcy91dWlkI2dldHJhbmRvbXZhbHVlcy1ub3Qtc3VwcG9ydGVkJyk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGdldFJhbmRvbVZhbHVlcyhybmRzOCk7XG59Il0sIm1hcHBpbmdzIjoiOzs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/uuid/dist/esm-browser/rng.js\n");

/***/ }),

/***/ "./node_modules/uuid/dist/esm-browser/stringify.js":
/*!*********************************************************!*\
  !*** ./node_modules/uuid/dist/esm-browser/stringify.js ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _validate_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./validate.js */ \"./node_modules/uuid/dist/esm-browser/validate.js\");\n\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\n\nvar byteToHex = [];\n\nfor (var i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).substr(1));\n}\n\nfunction stringify(arr) {\n  var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  var uuid = (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase(); // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n\n  if (!(0,_validate_js__WEBPACK_IMPORTED_MODULE_0__.default)(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n\n  return uuid;\n}\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (stringify);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS1icm93c2VyL3N0cmluZ2lmeS5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovL0NvbXBvbmVudFJlbGF5Ly4vbm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tYnJvd3Nlci9zdHJpbmdpZnkuanM/NThjZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdmFsaWRhdGUgZnJvbSAnLi92YWxpZGF0ZS5qcyc7XG4vKipcbiAqIENvbnZlcnQgYXJyYXkgb2YgMTYgYnl0ZSB2YWx1ZXMgdG8gVVVJRCBzdHJpbmcgZm9ybWF0IG9mIHRoZSBmb3JtOlxuICogWFhYWFhYWFgtWFhYWC1YWFhYLVhYWFgtWFhYWFhYWFhYWFhYXG4gKi9cblxudmFyIGJ5dGVUb0hleCA9IFtdO1xuXG5mb3IgKHZhciBpID0gMDsgaSA8IDI1NjsgKytpKSB7XG4gIGJ5dGVUb0hleC5wdXNoKChpICsgMHgxMDApLnRvU3RyaW5nKDE2KS5zdWJzdHIoMSkpO1xufVxuXG5mdW5jdGlvbiBzdHJpbmdpZnkoYXJyKSB7XG4gIHZhciBvZmZzZXQgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IDA7XG4gIC8vIE5vdGU6IEJlIGNhcmVmdWwgZWRpdGluZyB0aGlzIGNvZGUhICBJdCdzIGJlZW4gdHVuZWQgZm9yIHBlcmZvcm1hbmNlXG4gIC8vIGFuZCB3b3JrcyBpbiB3YXlzIHlvdSBtYXkgbm90IGV4cGVjdC4gU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS91dWlkanMvdXVpZC9wdWxsLzQzNFxuICB2YXIgdXVpZCA9IChieXRlVG9IZXhbYXJyW29mZnNldCArIDBdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMV1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAyXV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDNdXSArICctJyArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgNF1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA1XV0gKyAnLScgKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDZdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgN11dICsgJy0nICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA4XV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDldXSArICctJyArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTBdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTFdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTJdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTNdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTRdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMTVdXSkudG9Mb3dlckNhc2UoKTsgLy8gQ29uc2lzdGVuY3kgY2hlY2sgZm9yIHZhbGlkIFVVSUQuICBJZiB0aGlzIHRocm93cywgaXQncyBsaWtlbHkgZHVlIHRvIG9uZVxuICAvLyBvZiB0aGUgZm9sbG93aW5nOlxuICAvLyAtIE9uZSBvciBtb3JlIGlucHV0IGFycmF5IHZhbHVlcyBkb24ndCBtYXAgdG8gYSBoZXggb2N0ZXQgKGxlYWRpbmcgdG9cbiAgLy8gXCJ1bmRlZmluZWRcIiBpbiB0aGUgdXVpZClcbiAgLy8gLSBJbnZhbGlkIGlucHV0IHZhbHVlcyBmb3IgdGhlIFJGQyBgdmVyc2lvbmAgb3IgYHZhcmlhbnRgIGZpZWxkc1xuXG4gIGlmICghdmFsaWRhdGUodXVpZCkpIHtcbiAgICB0aHJvdyBUeXBlRXJyb3IoJ1N0cmluZ2lmaWVkIFVVSUQgaXMgaW52YWxpZCcpO1xuICB9XG5cbiAgcmV0dXJuIHV1aWQ7XG59XG5cbmV4cG9ydCBkZWZhdWx0IHN0cmluZ2lmeTsiXSwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/uuid/dist/esm-browser/stringify.js\n");

/***/ }),

/***/ "./node_modules/uuid/dist/esm-browser/v4.js":
/*!**************************************************!*\
  !*** ./node_modules/uuid/dist/esm-browser/v4.js ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _rng_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./rng.js */ \"./node_modules/uuid/dist/esm-browser/rng.js\");\n/* harmony import */ var _stringify_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./stringify.js */ \"./node_modules/uuid/dist/esm-browser/stringify.js\");\n\n\n\nfunction v4(options, buf, offset) {\n  options = options || {};\n  var rnds = options.random || (options.rng || _rng_js__WEBPACK_IMPORTED_MODULE_0__.default)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n\n    for (var i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return (0,_stringify_js__WEBPACK_IMPORTED_MODULE_1__.default)(rnds);\n}\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (v4);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS1icm93c2VyL3Y0LmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vQ29tcG9uZW50UmVsYXkvLi9ub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS1icm93c2VyL3Y0LmpzP2VjMjYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHJuZyBmcm9tICcuL3JuZy5qcyc7XG5pbXBvcnQgc3RyaW5naWZ5IGZyb20gJy4vc3RyaW5naWZ5LmpzJztcblxuZnVuY3Rpb24gdjQob3B0aW9ucywgYnVmLCBvZmZzZXQpIHtcbiAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gIHZhciBybmRzID0gb3B0aW9ucy5yYW5kb20gfHwgKG9wdGlvbnMucm5nIHx8IHJuZykoKTsgLy8gUGVyIDQuNCwgc2V0IGJpdHMgZm9yIHZlcnNpb24gYW5kIGBjbG9ja19zZXFfaGlfYW5kX3Jlc2VydmVkYFxuXG4gIHJuZHNbNl0gPSBybmRzWzZdICYgMHgwZiB8IDB4NDA7XG4gIHJuZHNbOF0gPSBybmRzWzhdICYgMHgzZiB8IDB4ODA7IC8vIENvcHkgYnl0ZXMgdG8gYnVmZmVyLCBpZiBwcm92aWRlZFxuXG4gIGlmIChidWYpIHtcbiAgICBvZmZzZXQgPSBvZmZzZXQgfHwgMDtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMTY7ICsraSkge1xuICAgICAgYnVmW29mZnNldCArIGldID0gcm5kc1tpXTtcbiAgICB9XG5cbiAgICByZXR1cm4gYnVmO1xuICB9XG5cbiAgcmV0dXJuIHN0cmluZ2lmeShybmRzKTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgdjQ7Il0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./node_modules/uuid/dist/esm-browser/v4.js\n");

/***/ }),

/***/ "./node_modules/uuid/dist/esm-browser/validate.js":
/*!********************************************************!*\
  !*** ./node_modules/uuid/dist/esm-browser/validate.js ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _regex_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./regex.js */ \"./node_modules/uuid/dist/esm-browser/regex.js\");\n\n\nfunction validate(uuid) {\n  return typeof uuid === 'string' && _regex_js__WEBPACK_IMPORTED_MODULE_0__.default.test(uuid);\n}\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (validate);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS1icm93c2VyL3ZhbGlkYXRlLmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vQ29tcG9uZW50UmVsYXkvLi9ub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS1icm93c2VyL3ZhbGlkYXRlLmpzPzA2ZTQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJFR0VYIGZyb20gJy4vcmVnZXguanMnO1xuXG5mdW5jdGlvbiB2YWxpZGF0ZSh1dWlkKSB7XG4gIHJldHVybiB0eXBlb2YgdXVpZCA9PT0gJ3N0cmluZycgJiYgUkVHRVgudGVzdCh1dWlkKTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgdmFsaWRhdGU7Il0sIm1hcHBpbmdzIjoiOzs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./node_modules/uuid/dist/esm-browser/validate.js\n");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module can't be inlined because the eval-source-map devtool is used.
/******/ 	var __webpack_exports__ = __webpack_require__("./lib/componentRelay.ts");
/******/ 	__webpack_exports__ = __webpack_exports__.default;
/******/ 	
/******/ 	return __webpack_exports__;
/******/ })()
;
});